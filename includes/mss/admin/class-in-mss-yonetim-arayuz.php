<?php
/**
 * Eklenti ayarlarinin yonetilmesinden sorumludur.
 *
 * @package Intense\MSS
 */

if ( ! defined( 'ABSPATH' ) ) {
	exit;
}

use In_MSS_Utility as Utility;

/**
 * Eklenti ayarlarlari, sozlesme taslaklari gibi admin islevlerini saglar.
 */
class Intense_MSS_Yonetim_Arayuzu {
	use Utility;

	const SAYFA_BASI_SOZLESME_SAYISI = 100;
	const NONCE_ACTION               = 'intense_mss_kayitli_sozlesmeler_nonce';

	/**
	 * Eklenti ayarlari
	 *
	 * @var array
	 */
	private $options;

	/**
	 * Constructor class
	 *
	 * @return void
	 */
	public function __construct() {
		// Removed admin_menu action since we're integrating with hezarfen settings
		// add_action( 'admin_menu', array( $this, 'in_mss_panel_kaydi' ) );
		add_action( 'admin_init', array( $this, 'intense_mss_page_init' ) );
		add_action( 'init', array( $this, 'ozel_post_tipi' ) );
		add_action( 'admin_enqueue_scripts', array( $this, 'stilleri_yukle' ) );
		add_action( 'add_meta_boxes', array( $this, 'intense_form_taslaklari_metabox_ekle' ) );

		$this->options = get_option( 'intense_mss_ayarlar', array() );
		
		// Register post type immediately if we're past the init hook
		// This ensures post type is available even if instantiated late
		if ( did_action( 'init' ) ) {
			$this->ozel_post_tipi();
		}
	}

	/**
	 * Mevcut sozlesme taslaklari
	 *
	 * @return array
	 */
	public function mevcut_sozlesme_taslaklari_liste() {
		$args = array(
			'post_type' => 'intense_mss_form',
		);

		return get_posts( $args );
	}

	/**
	 * CPT tanimi
	 *
	 * @return void
	 */
	public function ozel_post_tipi() {
		$labels = array(
			'name'               => __( 'MSS Form Taslakları', 'hezarfen-for-woocommerce' ),
			'singular_name'      => __( 'MSS Form Taslağı', 'hezarfen-for-woocommerce' ),
			'menu_name'          => __( 'MSS Taslakları', 'hezarfen-for-woocommerce' ),
			'add_new'            => __( 'Yeni Ekle', 'hezarfen-for-woocommerce' ),
			'add_new_item'       => __( 'Yeni Taslak Ekle', 'hezarfen-for-woocommerce' ),
			'edit_item'          => __( 'Taslağı Düzenle', 'hezarfen-for-woocommerce' ),
			'new_item'           => __( 'Yeni Taslak', 'hezarfen-for-woocommerce' ),
			'view_item'          => __( 'Taslağı Görüntüle', 'hezarfen-for-woocommerce' ),
			'search_items'       => __( 'Taslak Ara', 'hezarfen-for-woocommerce' ),
			'not_found'          => __( 'Taslak bulunamadı', 'hezarfen-for-woocommerce' ),
			'not_found_in_trash' => __( 'Çöp kutusunda taslak bulunamadı', 'hezarfen-for-woocommerce' ),
		);
		
		$args = array(
			'labels'              => $labels,
			'public'              => false,
			'publicly_queryable'  => false,
			'show_ui'             => true,
			'show_in_menu'        => false, // We'll show it in hezarfen settings
			'query_var'           => false,
			'rewrite'             => false,
			'capability_type'     => 'post',
			'has_archive'         => false,
			'hierarchical'        => false,
			'menu_position'       => null,
			'supports'            => array( 'title', 'editor' ),
		);

		register_post_type( 'intense_mss_form', $args );
	}

	/**
	 * Stilleri yükler.
	 *
	 * @param string $hook_suffix Hook öneki.
	 *
	 * @return void
	 */
	public function stilleri_yukle( $hook_suffix ) {
		if ( 'intense-mss_page_intense-mss-kayitli-sozlesmeler' === $hook_suffix ) {
			wp_enqueue_style( 'in-mss-kayitli-sozlesmeler', INTENSE_MSS_UYGULAMA_URL . 'assets/css/admin/kayitli-sozlesmeler.css', array(), WC_HEZARFEN_VERSION );
		}
	}

	/**
	 * Sozlesme taslaklari duzenleme ekraninda degiskenlerin gosterilmesi icin meta Box tanimi
	 *
	 * @return void
	 */
	public function intense_form_taslaklari_metabox_ekle() {
		add_meta_box( 'intense-form-taslaklari-meta-box', __( 'Form Değişkenleri', 'intense-mss-for-woocommerce' ), array( $this, 'intense_form_taslaklari_metabox_icerik' ), 'intense_mss_form', 'side' );
	}

	/**
	 * Meta box icerigi
	 *
	 * @return void
	 */
	public function intense_form_taslaklari_metabox_icerik() {
		?>
		<p>{FATURA_TAM_AD_UNVANI}</p>
		<p>{FATURA_ADRESI}</p>
		<p>{ALICI_TAM_AD_UNVANI}</p>
		<p>{ALICI_ADRESI}</p>
		<p>{ALICI_TELEFONU}</p>
		<p>{ALICI_EPOSTA}</p>
		<p>{GUNCEL_TARIH}</p>
		<p>{KARGO_BEDELI}</p>
		<p>{KARGO_HARIC_SIPARIS_TUTARI}</p>
		<p>{KARGO_DAHIL_SIPARIS_TUTARI}</p>
		<p>{URUNLER}</p>
		<p>{ODEME_YONTEMI}</p>
		<p>{INDIRIM_TOPLAMI}</p>
		<p>{INDIRIM_TOPLAM_VERGISI}</p>
		<p>{EK_UCRET_DETAYLARI}</p>

		<p>----</p>

		<?php if($this->hezarfen_aktif()) { ?>
			<b>Hezarfen for WooCommerce için Değişkenler</b>
			<p>{HEZARFEN_BIREYSEL_TC}</p>
			<p>{HEZARFEN_KURUMSAL_VERGI_DAIRE}</p>
			<p>{HEZARFEN_KURUMSAL_VERGI_NO}</p>

			<h4>Koşullu ifadeler:</h4>
			<ul>
				<li>@IF_HEZARFEN_FAT_KURUMSAL</li>
				<li>@ENDIF_HEZARFEN_FAT_KURUMSAL</li>
				<li>@IF_HEZARFEN_FAT_BIREYSEL</li>
				<li>@ENDIF_HEZARFEN_FAT_BIREYSEL</li>
			</ul>

			<h4>Örnek Kullanım:</h4>
			<div style="padding:5px" class="card">
				<p>@IF_HEZARFEN_FAT_KURUMSAL</p>
				<p>Fatura Vergi Dairesi: {HEZARFEN_KURUMSAL_VERGI_DAIRE}</p>
				<p>Fatura Vergi No: {HEZARFEN_KURUMSAL_VERGI_NO}</p>
				<p>@ENDIF_HEZARFEN_FAT_KURUMSAL</p>
				<p>@IF_HEZARFEN_FAT_BIREYSEL</p>
				<p>T.C. Kimlik Numarası: {HEZARFEN_BIREYSEL_TC}</p>
				<p>@ENDIF_HEZARFEN_FAT_BIREYSEL</p>
			</div>
			<p>----</p>
		<?php } ?>

		<h4>Özel Alanlar için (Checkout Custom Field'ler)</h4>
		<p>Özel eklediğiniz checkout alanları için aşağıdaki formatı kullanabilirsiniz. CUSTOMFIELDADI alanına oluşturduğunuz custom field adı gelmelidir.</p>
		<p>{OZELALAN_CUSTOMFIELDADI}</p>

		<p>Örnek: {ORNEKALAN_VERGINO} veya {ORNEKALAN_custom_field_1} gibi istediğiniz sayıda özel alan için bu formatı kullanabilirsiniz.</p>

		<div style="font-size:11px;text-align:left;margin-top:15px;float:left;color:#a9a4a4"><?php echo esc_html( WC_HEZARFEN_VERSION ); ?></div>

		<div style="clear:right;text-align:right">
			<a href="https://intense.com.tr" refl="noreferrer nofollow" target="_blank">
				<img style="width:25px;"
					src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAGNCAYAAACrPUw+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA/5pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTExIDc5LjE1ODMyNSwgMjAxNS8wOS8xMC0wMToxMDoyMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ1dWlkOjVEMjA4OTI0OTNCRkRCMTE5MTRBODU5MEQzMTUwOEM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjg4MzAyQ0ZBMEYxNDExRTZBNDQ0OTczQjA2MkZBNzE3IiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjg4MzAyQ0Y5MEYxNDExRTZBNDQ0OTczQjA2MkZBNzE3IiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIElsbHVzdHJhdG9yIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ1dWlkOjY4ZDE5MGI2LWJmMjctY2Q0NC04MTJkLWQyMmNlZjQ4MDA0ZiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTgwMTE3NDA3MjA2ODExODA4M0MxMTZGMTk0NzRFOSIvPiA8ZGM6dGl0bGU+IDxyZGY6QWx0PiA8cmRmOmxpIHhtbDpsYW5nPSJ4LWRlZmF1bHQiPmludGVuc2Ugb3JqaW5hbCBsb2dvbGFyPC9yZGY6bGk+IDwvcmRmOkFsdD4gPC9kYzp0aXRsZT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7lN/zOAABf90lEQVR42ux9B4AkRdV/V3dP3nT5uHwHCIgElWAgKhLMBD8EFBFMnxwoiigqRqIKAoL6N6CAIgKCgIFPCQIqIAIiiiAcd8cdd8flTbMT+/2rJuz29FTqnp7Zmdn3YG53Z3q6q6tf/er3Xr16jwCAgYKCgtIJQt5zwgnGyAsrYhfO7bvKNowdHMPIY7egtLOwKZZUfo4rsufvwCcyPCc1dE48cRKgv5Oak1dPUftJywa45vVUt1o9j8n+Jc19tjXiOLYZjb68y1XXnBGdu8OY/cST/zSGnv63NTIneoQJxsKigwMCpT1AKZSB6cINqPxDKl8ACAJ0vG+QCiSVfyeeBkDlnUCg2i7MxtV2i0DrnnexaERiiZcgk7HZn3b1/UgyBeyPLEUstBJR2gm0dIkOqSU1tSQHxMSKSEGP1JzIewmdQUfqztK5oDXxO4VhEv6z9l7PchzDisbpH2WUNN0HWPSICP2HEBwsKO01SMADLETCpEp/wgSjqk7A4BoYoBw0hPs74RwPGmDaTRyA3YtTgqzmgOE4WAExTI/FZ3obYlK0QtBCmewBoWIyIEG2qqnHdLgWoIiE/3hfxrgp572uCvimijgUUABIaM/c/URs+q/JObXJ+zKCFspksyoiAweQo1gVqOpdG16eJuc/RJM9TWVxQugfL1hZzA8omLVM0UkQtFBaxaR4wAQq7a4wqerLaw6KWZRR8xMqTAoEDE57oXCqM62A3jkuswIxmzZlJ0PQQmkFk+JxIKKh5DUcCQgH6GrPBAqzEjSOaTewNxRgD5rHgiaoNHqUCqxUUGOrTloGLcPIFwFXD1FCpf5cNWeMybukBvVAxz874b4DEnNvsvqAKIY70XzPD9CA4ndZXJt4BRRKi3VB9WAcrCjOEEd9PVPnAsi0UMJkVEQyeIkhmfaJv5U5ImFRrQAr0GBvorYA5x3web2w2i7rX5ME04M6sNJssK17EWRaKM1gGaAaaMBztvOiqEBGyprCqGTXUPu+3LFdUGMMVf92/6x+ou1TYzSVwMRP7/ve32XnEDAdq0ECMw5WPvrY9nMBBC2UMAc4yFBMMiihbhtM7bytx1gauw/ig+HUAlItUIk4FFQAAzxgU/rLDUQ8QPL+7g098B5Tg+aSgJLK90x6PZM03n/jPivPrAVhMCwELZSggxoEpmDpd1cogjuGSkyJJhxcpInABHVXkzFBqHhzBMyoBDyeE5Fa4BDGiXmOIa73qjFQBGqj8FX7Aet+gvtvCbg1yKyAZwYqwMoLn2aQC6NPCyWIsoLAjCIe028ihopony9sBuX9HSRMz9CJ+gYF65F9RcMfpgPYoPlTZsIF3UfIBSvin8naQR8qMi0UnYFBdFCBeGOn3N4tUXR6uKxK19ckBC0gLuAiXMbkp51Ex4yWvs9nfby21/rJDFdWiYnvmvSnbQaLtgKRz8oRg1NDq4TItFCCDnrQ/GLdxlrDMJq9VViPWZC6gazyEYkCYvXbBXU+sImf4DoGPJ8ZNe/qfCbypbm/Y5aABhp6GnVxVuD3OTTIsJBpochYlXBXDAhJ1rgvq9Yc9GF2hcas3MYe2y/nQlSOAxuE3I/XP+BZTVQ74GtBh+dBA853iC8+JvJ2sfxXtmmEx6wgKNMNCbAQtKY2SBGOCQMaX/Dmoho3pcALfURrCIZnAnqGbRU8IahpZgjNyYn3iWZrvMivCyNB4IZUmJURPrMiwU15OyzlRdCauuYfaKIaeMw/kM7JzQenGr9OKUKAH58E2tfR3cTijdgCH8BCtI8Fg/ja4uT+m4FVxISG+rzKrEzXs5d1aEtMQgStqSlE0/jwjhg/LCmUNMjCc0INiNaZe9y9iY1yNlkP+r8K0WwBaPK2GlYUUlCo6d5qFeDheTHODluREbSmHsMimgcTn+aKKq4oGKuaYFaEMyjU19PhUcR3W4Pc53iCQmPC9+ddAHPcKXdcFyAu1ut+v5TE0wzuYK/eS6TSvzyw8rMf0ksD7WYoM4JWdwOVNwgUfIxGULAl2fI2aLbNkJqAld+B/z0xeKi8TXp+JdH5dYaJLAe92/Un/Vzw9zhYNeizKgWWGmQieaJCQfzCg90sxUbQ6l5TEHRGo8ejDh72ARr0v1Hm583F7l7RU2cyAEWEuzg+TLanUXV/3rHiZUYqkAdNxuZtX6PMahz0KplCdcxTnWJEYI6nc28uYCFodacJSAzFrhktEKkHLhKgPbobgaEB34kfBuU3W4JOu3jHiNYJ/bJRN7OKksaj3iJuZmUYvvYIivlsrQluN1vREbSmALOSjHRQnCmoP1bKYMY3yKnyY9W+w2cvcue4DlgSIgenIHm7oOIfqt6qU2ma97ZVf9OhaURD8FlVQxfAx/ekYEUI1ww3W6HsGBHfPaClHKQuCgbCMzSuCPyNO8AflZI5vJ4IeLN2BfC9uFM3S5iUzl5IULBYzx5qaWIG798MrGIh+KwiroIRhNOpyhRCgqfCY2p2q5S9BFr07vIOMq1ONge1/FcaPMHvylh9Dq3qPjejbiNLfRYEkQ8KFGt+RMvs0zLtdO4xQBxo0KFUAiszpO023h1KEsqs9luROrBy96/dSsU3KQyzVQg0DzuTWRk+MAk01BQCtqH8t4fvaWU/kBldJFgbgY/bor8Dg5TvSUYcNhoGsxKagRD8GdcZgBzgs1ut/Mi0OpdlKTMvCH01jWVXAJWCQ30bQeuqRPtIb0cAiB3/IPA3NesJuLMuuO8NOEsadpjMyuCgc8B4KyDeNk+Y1S33YXGZFvq0Os4c9EWBONQLmtVCUpvMBQQgQrg7H4nWJcZLirlMQKlPz2Um6YOVfCs2eEzYCXyY2EANwPPHldtcZlYhZ11wNwQaeIYgQDsyyQwLmVbnmYNKH5YPJ7s/E0HMNMBjCoKQdYiqP6vbBD7MG1Cn7dIyVfl9TMaBsupkd68+ln+KHVvsGLbVJm42Aaw0np1yJZV4zXuxX9CezMGAPq3OZFu+7acQzUA9BxBv47LP7TKaDa42IdjWGuCAJ9SlrKm7M8/qIwhsr/H9d5QYJELwWVkesAJBEBgEuH8QgFVoGUeRaU1NllXzHojYFeHCBTR0zarzyJvV0xAwKUNq/oEGQPlhVDoZIcCTugJcfiAACbAKLFf33kHR2LGaxKxAc2+WPARGzayg3QALmVbnsCouKHDBCkI3BUHhc+KlsBPZZw2pGAnKpGr9STzGZGiwKh0mOM6s6OUSZmOO6maBFfDYN6ix2m6XgYFMq/3Zlf6+OBLaNUW0BiSQAAKQEmVC5flbiACodMJRSc1AJLX6zDuJoKwZbx+jepN2+T1GABIWlBztjQynOp+VJPG6r+vw2JVIt0gbAhYyrQ7xWyk3FULDbKYunzmQuiyV7gBSQ2oKCu7FlZbFkLAUfdPPcPljJGYa0feTiVY7VW2JuJhV0GEkcrCDIe8v9XOHcSc7aJqCLd1LGIhp4d7DtmJY3NlOSDeCsyveKUm1mCgQD1C5r8iPOZKBrhtUatiKdhQ5uMDJ65syuMUWDI4lJerOoKrPzMCkBeGDlSRboH9mBdzalDxCDaRNTUIErQ5iWZrQE0biPTDU+wLBZyS9yrT1m8APgA+SfrfsQIPPx66YgY1kZhWBlSgDgy+/lTeXe4BG2u06SBC02gOoiK6twmFZpKGBWF+EAqTQQeTs0BWhLvOT6KWFIeIMDNBAuTMZCAhXZCs+KxMoszIa8llJzcCQ70lkXnprfkC7m4QIWu1lDoKWnVgPGkE2NdcBkWRvop98T+ABWBDM/GpeJVjpk6SQ8VPbRhnAKjg/81mlmuSzkm4f0GVWNRNCxYh2dNh1BzEsBK02NQM1A0V1zRJRZLd+AxTmosqxrSyX7gIqkOxI9LGHjpvJFGr7Q6f/xsGKrQaSxhiPpRPBHthvJZ6I/KqY3QmDB0GrjdhVk0xO0FJg8LcS2JAJA3Lg4ZiYemEPteYQ+LC2ve+VwcqQpiQOzKwM/cyhoHjCdUVhQczCgNMPHWMS1oEWxmm1nGHVAZeGOehz4q2/qjDeSl7Dz8tYuE2t+oGIDlDVm3/ukzlQn+9BppoO6PeW7JxhMiu7UjC1rv+00l2rnOz1bFsW6MoFKQ9i2Z00iFicFss9nUOmNXksy1NWqjEW43cwgDRY0juDgy8zELS269RdS3HfDqf0li4TFPUHA6sey2gIrIgLrIQ+vcBVQcCTRcJQ+q1Ac9HD7rhBhEyrZWAl+oDUaBYJ9ZqgGMbAuSbXF+QbUCeo1zi7AX3zzBAAuyEw/XTOxQOsaAmsIDSw8jODgJ++JJ5JQPYsiH7HmJ04mDCfVvPNQWG4jesDnuFGAlynZlYGonGsxrmBk0ucqMYm0cqxDj77T+anUvls6s1AY9LBStUHvHgrnUh2kFyraZWf0afVPexK1xEedCtO3fYaIFqmmm/zkuhFrfMWIMHnyhiAvHagDpDxfm8Gs+K5IXnFTxtKF2OIwYqXwgsUzNbs5IFVYlomMZBoNYdlKRl/SNcgHLDSybpQo+iiPEpE3Qbg5eyCWl8YaAKVboFYXRBgPrCwfVZ+zVxfW4aIZ1UwhAIdrVkl9BMx1yho0QvlHQeZVotQDHjLbj4etp/6ezoBFqBRCILPBvixVdrJ+wzxCiL4YKs84KvedZQiTG/Iq4FKRAIx0+M/jQpEEQ6zAjmzqrsO1JuCrcnp3kLaY5oGMq0msSvik60EVhYCgkEC+oDhZTNEDVYqv42fsvJB+wQ49+JUfFa9ITCriAesQHB9HVNQq6YgVFYEQf/eZSfvyDgsZFqT48MCAbZACDBVO6USRYv4LE6acZP7lQn3OhAXqoHaf1IDVERzEOrcPfB9Vr0RCGVvoBSsOA/bT6xV+Ry1PFJqFhOxz4pnPvtmWJ00+JFpTYZza4KDNVLuXOw/qQcrMOS18KoDQ2p6VNot0m+iamvQQqEVv1T1BSKwsqHEJpoFVhBCLhthGVpJuhgeKPkzbf34nyQzC3gD5Frkw0Km1SJcEg5698qQ3nl5WUwJ8YY1gJajO4hJCt4iD6A3iADkDnRlSTRQh1aMg1XIPiuQAEgj4FsmqCAkN+PPWxFrJQtt4DIscJcGIxO/E06eVt7ucUJ8+LA8O93D3rSGTCtk3xX3ubqZj35PE6M++V4pWFOzgJ/aPPF/0378TLqmNO/7jiGPng8DrLR8Vu4+chrlxOpZw8/OALFvDOpNQkJqnX/cXEGEY8eDUVNsss55Bx6wc32PNJY0Sc60LBODSwP4rlTgQDhqGDTnFYA3fFQOA8TgT5LyAFE+AwDQCzUAkAONMNAW1N+vYgaLKWQ+KzvkvYHK5BoiX5MGXIEisR+oTEFNZldOkEjqTUL3tgY3+9EtNFlHBSvgRDy2wHj+IC9ohWxOlpgWMw+LYKB12LgpyD8GajxN/r5b9eATCRsT1bjyM1u7IBb8h18ETWDnKA4CF7Pqs8L3WRkqMzBouphxkNAvzyW1siQAy85rqnxY0tw+II6M4UbyeoL5CKm9wfHqtV4rg2PjkgB0v+zTwoh4vywLBHpBDO8+PeL7/KAECHAlPKmNxpGCCNH3d+mAj2rzc6MhD0YVrELwWVl+wErFaBTn8K4FQkBmpdruU6UZDs+HFcYsrLUhVMSeCIeiQ31hAOW5jXqTdXzvIeJRQ74awq2U488JqR9jBXVZPhtih8Tn90DbDVsHVA6oI96rcVZ9IfmsrJAeslaclc55QtoKAdCqwFGRmUg4wOJRELfNTzwMVJgu1pNFwLtiaRq4Ybo59mKDgAL1/gB5JnfO81WwB+AFOgXMRKoMJtUwLyFEZsUzA+vaSBo3BYHjuxEV2gBR5SFOrBff/1edrtzlwKB1gEUkVJkY/NJNdQ8aPGah50sgCt+tMSkrew8RtHw/Ny/rbTRTg9ylT5RAoRdlzs+YpwM64BPjSqwJ1AAXFljxVgM1aW3TqLhqDOua1JOeIrnRtLVcRiZz4AHfX0JI2T2MWR4CWU41LBYCnttP7id3i1ROfZ7vvlqvsFTlhqdLYek36N9Ts5mVlClCAF/cOLMitfFWGn4rXj4wkF57Ihav6idjNSnd99C22Rp0WZCf46qzJvNp2RinFdCEa2zyUQMlSIui+jPPKiuYxP9WGQlZr2WboJ8jKyywEjEraW85Rt3G4rAUAwJ+nV98hEhXDdsWsLR3zGsmx/eytHJhC4zT0gYTV4gL6A8TbS7HNyxB+syJ1OfEX8VSBXfKKuP48/m0DqxA5bdqxMKpZGAoM1VFKBMR+K2M+ugB4JrUE5MVVPd6kkkALJjMgaZgXci0xM+sZpASI7Q8WEG0BXyzan+J1MGHooKLAOr4bFrus/JexwniqoEaZ7fSrFRsalZeE6rRfHLj32wFGLWiZFTQtiHT8gn2xAitr9RTBZG2xz1YiOZdqJiVlj57V6wl+sdCF/qb5LPSGgCOvgldix5EmidLxqz8Odm90MhnVhP90AAA6NJkIjhWFoDa0sFZYVoFjIjnPu+a5wTio/xMTHp+qvqA0Tp3gSBYvuq/AlAPHGLopyuW6TvPDGRg1cwc7NJ9glDPlgP5mCBAhSSNTc0TkwWR4iIEYViBKofIbGyjdq8ikcyifpZKgwoyrXD9NkqzzsOviIJ3jeuH9oPXT3nDG4xEdqwGs4pSFO2zm5wplNNBhNMvxNezqs94IBx/ZCLyXZaTHWSTVo2THZTtNHVABpo5GlwzgyyYDBTAF8YeavRp+fdvBWfGoMFUiHTykqf8A0N3Uzb4MGOIhtlT9lkZTfdZcWtGasRH+amJyMscKkqno6wXKQGrcQwQFKYQVs2BEMAn8PeI/8bw8kyLOlKnmWWmhfm0hN1fm83Y9+MGpUMApCahe6cEqK6mOUpFNQy5uiaxeyeYlTEpPiud7KHq75OaVMeGxCqqA0TQM6nHwVU5ddWf1/TvkBM4pzQV33c+HMJBG+LSxyoqc9oiY2mG4HfwMC3VcuxUMAnb+pxEzN909E4UdyX0dYE4J3ormBVI2NVE0i3xvYqmiAnHuToDg9sM9MNO3Wa1bm1H74F2qBrmTv7nno2JwBFH6i8xnnKm+jl4tuOo2kb07EVwZYYA13EEJrbx2FZ9RPxUMxe5e53rPgtSMQc0rknU/ibgx2ARdwZUn1st/Ebkh8WsdFLE1LWNGHr3qXVODVqmcIipVgQnGJwrcp5I+tgDnHZQoAKh0ev6ruPeC+jO2le5gAM1Drw6xXTvEySehLyEr6zEpcSEx8xEvckJeiPVYq1FmKyMz23jrwKPdoOWV0sTCj3LfLogqAMsOiuX2kn8BN8Li1nZfn1WRI0tWo5voliJ9bAwQ8OPJ+xbRfoV3pYeedUcP2k4vDWVeBSr7u6J2BAmRi3d4dm8FQpUy3pce4/cDM3td1GYmeNX9AIgKefTKkzhvYfcyjlGsAIltVngCTepnjRxnx9LkfhvI/Fp+kdNyqxaVT5eJo4P89F9hNcpp5GML1i0P9TsEZQCLtSTlnrAEviAxFBJjHp39sTPWnUjyroWYLjMMSlqkjp7gLcnyVvgErwoJjAT6zCTuJIAYpyW2DQLCn68Zycs8iRgUSBJaaIYuI0MxmhIdQN9MyuFKRh0RdD7XHlpp0HTFKwHK9UxHHLCab/tjyt7U4ISqfngN+DOr0OeeFeQXH8TQ8GfuU/bC3QwnmGTYOZSLhEHn2YhL4MGBKhzKM/hTmoGn2wVsL4ohmCTcx1YlX1WLWdWvCXxQA3gsytd9xBoAqDBi7Ui+sG3hg5g1VeB5VGTxoJJm2Kq+AI9TjZLDwkzSflVFUy3rIYwf9uwJqhRraNd4pAn/JxqdWlK3D4x0AcAru/LtRgzUd2mNWAlTRnjBPTHeUaJKhiWSyg0i67WrrKD/BiNbBL8OCyHCKh6mNASzOshyyYPBlEZD0pn3QRYQQ1YIWg1B+SAs6+G1JiFClUi9WAlYnGBtNIziCaNWYU2ytxOdkX8E5GQGa1rQ70lo6pPqLgJuw7lHEObTYXUfVwIEewi82GN+23fxNVFYDUVQUu1g4AEMAtV9obUU8gxiQjhh5uCDsNSDb6KX5MtaMfoLz0tBCtpWfmAfjjtYE3OyFL5BsVJf0GrraKAYIfLsOpMQJ0OCL4pBjh8R6fjiaHevEqEQKhO92Z5zEA5aE3xiPg65uLXLKRsqG7RBLhxWMQQZJMlOhqi7w7ivc/AKsrqBlowaWDlXukG/8PN5T+Sl+dS0gDQATm338oV5cVbGAH5/XhxohawCOHOUH4s5aAcp5ENtuDzbyEIaYLVBGhV6h5OVfMQDCUn9mMSknG48s6gRDh5OTrMncgj2mVssgRWpLVgJexut9vVd9UbqGNWUh+wINWxDrPirdyL9gh6LUfVeoIpoub8fdMt2Jzi9oMHiWz3fp/og5UVIOynxLSmQGELYmg8i6DnJSAZbEQ6yYn2NRLiqSqusQLGLRhhlsvHTyZY1VRYdoIMwYnlUmL46xP/Dj/vRANKX5gKrISBo37gKAzY4kXOEs9nhHj8EoSzZqkKAFUMLssIBlZTyael75H0mxeLZ6KF04mgEe4OnK1G1VdkkphVkKrJsu9BZSCBpPiplDnpVmn2sCveqmDdiqBGUVXLNYRtv10Hfp+WwHkWxFQE994/nYek4b9gymiFMDimpE+LCwT+HO/8uL36dUJi8Ota8ppBXPvVgoBymGAVMUig5HmiSV3UXiLwWZHxFLFyvxWozDZDY59gjSko8VtJzECvuW/Rtg+YZqmuaA1gQYhgVaWwQVIj1+WiJh6nGriMWTC43ntwo6PpObFrL5xlhlvnbCr6tAgHbILinq6+VEGLSGZ60KjAwAM+J2RmRQIClepD7aBsoj6/TlaHQPFWotxWjp5RycZmPyUCzCyvdqStugUtRSL+OtFXxKmLOtYMDoefXdFrFxOHMxEY5Y2qzSjKiHFafokZ0RxO4r033lAuIvCV8OKzvDM9A6ueNnCwc5fQ/ea48sZbSVYFQcNvJQ5fqN8ZLmRroAa9KlgNUEYRhaJi8zNnFUE7d41fG89QJRmZgEyo+4so6quQGjPU/TwsquF2E+sFdSNo+Um5ogNDdaagdKMyEX5ZeB1Ooj9QtIGBVWqSwIobYgH+WJYhMAtFYCWteKN5nQk/1QQ4gszJroiQH2dW9CFESS1R8QCWP5tfttlUCFLE+ycx1BtcCXdWVgPdxJ/uGZjdcKQFxc260adFNAZ+kOBRUtnDWXv+et2QgRMBdR0+2Ta8sMDKr89K2tEcmxd8js3AoOmjWGrV/JbmZNdgiDXMimjtJVSv0UhtYhWTckX6gSHPewQeJQQX9fftF6sBq9ahRzf6tECJYiTAOWUgJ/6sJo6HiH1dqkHH2HbKLO9uaDVYycqO+QWqGueca1VQ5DNSmW3qSHbg/i6y0EBhodUwK9Gz0nYlyRgVyFCZaCt9fbK42ncg8NRFSjcaNVuPGlXzkOXTcrrRpwVe3PLmztAcbNI9hcL8G3WTGQ/sZE59NoElrfJKcasc7FwYJv6ynAqPJHJ/n4xb+Av6rk7C4syhbgAESTuccbAypWBVB1h+MjOKHFje1SKQUF5QsDsQ+NSIhgK4zxOhf0XNyRvTDLRso0sd8S7UCJq9g3jT+khmbX0zyJWxgePzqi68MLAyjckJXfAu8xPC70fd1VMwPADio+KzLJqd72TX3wsje7+0KqvBrIQMi6cIwlAbh+9vcgd5yksB+d8gzXVIejrWbQqwTphMsPL6tAqO051My/AfxkIk01GjqRJFGUfdPqsE81m1mFkJxwKR67YOuyKENObj0qwnWJdEUxAbCZLg0OrfDKz6NJhVHWDxDnZklU2BH3sjX2nQR2QAvfJLvODCcbAy2gOs3D4tuxvjtCAstHMXPyVS0KpP/MfXN+JZYTYqzCoxCcxK5hKBoKivctM0aAqCIWK+RJnJFRQhDJYPZiVlWEDUTnUQAJXYHgdlB8s2RXrJnbgeIakwKzBiZvuN7a6M0wpYxbZusiG10dJEAVru8c2LxQLXoKqaW3aFWU0WWNV1F1GnHdYys7xbb0RmKFGPPyEIQf0CiYqt8c5VrDDcftP0BVZiwJL4qqT5bIj6bHU5iggnKFQ4A9Qm6hMhO8tbFDfbd3x3MmgR2Yxety5OAp1LRjK8aWZAqHv1m6arzIoYkxu6UOe7qrbfCUJiOdTA0TfXfWXtdc0KvHgrnfxjMA5WxDdYcQELiA5YEQVQgfDh1DnHOXazvN6dfPd+jHZqO4OV16fVaXFa+ltI9HJj6e755FqPULvboVYPoSbHfwmszMllVlzmE0bWC6JmotIyXVqFTUEr3kpGaKrbnvoCMKt6wCKczgPvDREFqxKbfQB67EkWFCqLAzEqzCphds7g78Q4LSLxw/Btm7Dy7tTrBtGIjofKFiw2iZF2BqugMVcahSRAYQpqcLY6cJCZgqIMDGWwIoHBqjRm/DjvQAhWUMeqlEUZa1ShNgFWbRns2v9ceF9z/k4DqxqmZZKuKdJKDD7LUh9PKv/JYU6UIo0Y/NxYdolxQ0MVCYKuBkrBy4ffD8Scp9YS0agpWPO+dFxqtJ3j4xJdizHcvpKDnTS0RmNX8dkxOLEYwDcB68GKn8lIhLQ62dq97GkiSM0zgxpMIUmJ7neqdI0j3kc5LfE5vLM5qXMYeFeDRX4sq8K6SWO3FDqz8pOrDZTsyrWfT3NFXT9XGYx3rCwXvCMAyxqwYszKIA0vKNvCp+TU03E+WBl1YCXfdCqLfIeac5Qpv+j48r+M6ifNzl9uG4/TKjraecMmm0mpNz37T5vMPyc/v5UnzVMN1rE9gWGAVRjMSgrWGhuCJVBSs7lZCFCKTAygSadAM+UU1DErsxRiFMYoteU+q1pWI/JXeZ13IkbFv5SnTLarUDmAjBBXwaox30S7+bQ6JU5LFvaiUyhEPLiJZtETsZSZFUw6s+L2FeFvCPZzNt0MojrmHhh6e/14wAeGvOzXBLMKb3zaqt4FxSNwMyIVUIFolvCUP1HdnGOUTcBUF4FVpzEtYbQ2+H8edayMEL1SLSKwMo22ACtpgKgRUHE5xQNAVFBVI55S9x5AknHfa55XwYrtDYyEPD7tGkOU1IKN2MHeGFjV5OgxZJSTcP1c3QpWnci09FSeBIAv9+ZpwnUsgAftLFLe4N4uzIq7cOqqIi0eH+EApapMl8qHLApj8GZ24IFVX8UvG7b62t4p0w024+ipACvx/CvwUXmcePUZKPmmJXslS6lAuhesOolpyXJTGUbAgFDlNfgAaFX2jLYLWIkYFjHUK4TyZInV8A55cikg/kBN2euanVJOL22GagbyAcujB7V2K3BNNr5znQdWUJdnG+rCIIgU+dm1khYYPVMArOqYVhHa8n51sn02agGpJsNSP7UZs9ICMEfcgcIwBkIM7x5LVRhDoDxXNXnrQCvmyqkwq96QfVZSH5bXFJxoKDFUuwNBEYEu34VPpEBVZVZTCaxqmZZBmRa0JdMKsr1GNay9ZdyqBiJPd1joXaQNmRWRfSihN6BhKot8VzLnuH7bJwJ0/awKln1WZaugmePT9nayrImqGCuRow5AlFyGD1TeWSNJbYxea+qBlRu0Svm02pRpgeYQ1nt+1RxWIFmPL7/PHOx2mzIrkJFCdXC6mtlqFoYVXUSW58oNVqqkfLU+K9J0/TS9AEK47Mozm4I4tgq8Nw+kLk69jOB6YJVgNNOeumBVw7SsBiuxNAms9KLStaGq8jsvw+jExMfMQLtBZmU2Cax4W2t1MzKIWI/bjwyGEejG1VEUtfsOdIJaqxHsEUJaMj65KZJ58Va8FUGQcDHVjm2Zbe1mVj0IVvVMq41WDxtL2uf3YJgAGtJ4gj+7ST4r0GRFfqrT6DAm4Tl1t+CAUcuuRJZThV1VfVatYFYcwCIBSqcSoRlouAJAVX4uXscgWMl8Wu2VuZT7jCRVofWeaX1tJfa7yUq0NYgyZhPBStRBENT+G8+d7AIVHlgRebl3LRZnECFN9BIMxm5Z1oVIi8enrUPhvexKHL0ONfakF6xk5p8b1VNoBipAq1PjtNTbdGSphRjQWG2y3UabXWmCFfg4n+EjC6928VVwjUNJymP2spoYZ+XTh+XWE9VSg9gZX08oPVBYN0sgWAViWhS5TNL+EEVUPh4pu6iYgfSn1aCDvVk+K9G9idLH+PFd1ZU3D2FQKGPbgH9PpbTGZjnOqpVmoNKHJaKC4hzuoIzcFVXhcH8TwarbmZa/qPdqNZ0SWJHGgcRuZZyV9041I8zryRSpYzmya9eML82iEjAeyM1fGXQMt8/KnBRmVcewatmVJwpDs3Xl8AVvFA2pyW/F46usM1guK/RZdS7TItpv+mNZYYBVK5iVCESgAVYEhNQhDzfQgzQW96bMCNsmYFVnEnrVifh4MO7b96ZFdR/onV2Y45gFhfY1WMVkyjMtlgSQdNd9sdvpFGYFARGZaMCI2DqRsCc/q4iuK/KCTtsFrGoBSxYgJrjhmiVQTmFFXuhC9R0HypWQ2b7APmRWXcO0RCNSPxdH+dgys4KGlbsVzEqj9oo+0I1TKWLUJcsCH4hH1KAGPITytI8F5/a0CVjVMSwQ/KZKwKfjD+R1HIJVdzEt4sO/owSsENrSqtAFrmeu0XztIK9v4B1XdeQA9LLq17A3Ug9WvW0EVrWABfzVnNoQkPp5knA/JbVhDJy7TSJYNZdptRnL0gUOQqDErjqBWckAGbg+kUbPKmav/icLjyOHtDez0jIJdWbTaqYFfqZRL/qX/0sSBKumMy1rcpgW8TEQSYczq8b7QdI7nvgtWSEX8aKWyJUDrqKoE+mla8CKkLYDK0OmH+OdwGFeE53F6w5SS5E9309i6ELXMy0S4NgwmFUrUsRoAQ6Rg4fenRBtxqS6X5BOGVBT4s+umoGEtOX4NEU3NqFI/ksFeVF/PPkegtWUYFrgcxiaXcSsau5TcMOybTPgneEF1WgkcZ6KZ1OFKlIzhqHyDFKkvF+1XcdnTQI/wqFSqhLZNUjtfSCuL6dMMHosBKtJYVpGa/Np+XnGpMFiEVXAaxewqpvIIUj/QAMXloNiqSAW1LrzGbtqV5+VL5NQrgFEq//GNzIjWE0qaE2WT8urLu5pjRhGKCW0rDYCq5rKruDPjINx1lB5SagYN2soUcPdRDLECb9zaTWQtD9Y1QIWEfe7GvPFyalLzArNwPZgWiZpm4h4Ni5JSKuBbVnwG+QAJa5TWLvZTZWChvggZrxz2hVmZZPOGJ+m6mahxhTnk0xR9G0SzcD2Y1qTGRFPvPrU2cwKVIAi8DNBA9fzslVVGpn6CPiJkcz6L8XAqoPGpx1sflR/nuzyUlwdzbToz4IDTc2nJWLmYTC8dvNZcYdHgLxXJVONqHb31V4uyCOsmoEpi3QUWNUyrCA8V6CcCFbItJqJCW0JVprsSnZndVXQNf1X7j9UrAvYlicGVmbngVU9YHHs7lqlVk8hCVLecmMYCFZtz7TM1g38sMzASJuAFW87zvjfjtF4VWcSoHMUXy2FLgApgxXpzPFp+uNT/KR81XfjlFmx2oEE8aBzQMvqDKbVTmAlZFQQzG7xYcyI82oqSoZN+Kw6F6xqunZ89ca1PkoEHcFLpRwnBpqBncy0SPOAppuYlZDFgLqic9hWh25a5WpQaJJ0NljVzQWE90iUVJOUzMCkZSCzQqY1JZiVltWmERNVCyqqvKBqk1T0TatLwMoDWFD3FHTKEMUpJUtY4c8eKC1WBNJcptVtYCUCjTrzUBPkvNU/wW9DJAM80SVgxbe2QdW54AIrowRWyKyQaU01sApq4snMOKjL11v/Pd3aheACK4t0D5kweeDkDUAmpD7yPcYAC1cDkWlNYbBq2GysO5aM37Wq0pCKqVkuZtVV+umnw6tMN0oRLY6rgV3NtKKTmE+r48EqyC5zQgxDg2HVMjL+cWbJ+ukuZiUELNfWy9r3Km9E6c8YMquuF0Jabx52uhlIFDmJ9bLZS65L9AZ0Fay6cjKt7S7+9vIqmsdI2Qw0cTxPHfOwRaDVScyKhPw98IS1gyTKvQ74wMOszO4Fq1rAMmu6z5WBrCxs/1kUmRWCFpqBQgDSYUCE+15t0ntRXxNJIj+zRCiIYXW7PqphnJSUKYa0amqDVpMc8Z3ssxLtHZRlPgERw/LuJdQ1CaH7zUAxYHmqcDBEt0vMCjnVlAetJoQ8dNNqYGM2oyLbn+S0LPsFY1bmFFkBqwMs932zJVEEK5RmmIddB1aiMvLaXE1data7N7BqBppTaLneFME4q7obQbBCaQJodSWzIp4Ee8Q/2SI+UK4EVu2abbXZgFUTxkAYs2JghYMTRQ5aQWb2rjUDvVSIUw1des8wwbKIKWdpU5FZCRkWc9zZCFYoGqBVKmwxhcFKJ5860ToPkSKUNyYyOgWZVQ1ggRuscCyi+GFatt5M343MyrtKqAocFZ+nXC0HOAkI3NdhHpqpyqwMVx9UEvojWKE0wLQImoE1v4d8syVmRciU3w5nuk1BFJTATEsAWuZUAKsqTmnEYhFN09Ddl6wPox2ag79pgIWC0jBoeQZVOxeMCF1I7cKVlhkpORxc1mEEmRUCFkoTlKkaXFr5u9vBqs7prixkKjkTZ/NgCayQWdUIuq1QQmda8QgppVhxihjHxwO4+lQxUGsDVv5EZoUMC6WJUqrMQkfY9LhtzEjYJWf8VIIsIAo7T2gS1jKsEliZCFYIWCjNpet0hA1E7VKKkxgFq4GEVRp4U4E1VX8nPo6vA63SgCRlUxrJKQIWSjOZFQWoqFUCKpZwk71ilmkMJLubaXlzU0HAs4AB4+FFyKwQsFCayqyqYGXWhSN1O9PSybVONM5SXlFFsELAQmkZsxLlGO9mpgX+kEkIehYuBSJgobSKWcmBqJuZlt/QBj5YIbNCwEJpOrPq1wArL9OaVmFaXds37np4ppyRVcEKBQELpQXMKu7TxCuViKswrW4CLSJjXIJjS3iGYIWAhdJsZmVomYEqpjXQRXFaIPoDxKCGZiACFkpLmJUdGKxqQavi0+pCm4hUfVmEz7DQDETAQmkJszIbBise07I6nGkRzTfRDETAQmkpszJDBZYq05rWpUzLm9sdwQoBC6UlzMoKjVnJmFY3R8RjmBUCFkpLmFXzwMrLtLrRp4XMCgELpaXMymwJ6+lGpqWzGRoFAQslFGZlN51ZiZjWtA6MiOftKcSMCwhYKC1jVpPDcsrBpZ2/9xDBCgELpSXMavLAysu0OnXvIZqBCFgoLWNWZluwmk7N8oBghYCF0hJmZU86s+KClt05TAvBCgELpWXMqj1ZDEt1PhUyl6IgYKHoMKuY3bZgVWseTo0c8SgIWCgyZmV2Bmvp9sylKAhYKDJmFW1/ZiVmWjYyLQQslCnFrDqUpYyDFjItBCwUZFadxbTQp4WAhYLMqmNAayJHPDItBCyUrmFW3QVWbtCKupgWghYCFkpXMCu7bSLYm8m0IqaBoIWAhdK5zKoz4qxCY1rJCDItBCyUzmVWnRNnFQ7TIsi0ELBQOpJZRbufWYmZFsZpIWChdBazmqIrZ7h6iICFgsyq85iWjXFaCFgoyKw6pU/cWR7Qp4WAhdJOzArBSmge2hOrhygIWChtwaxsI96lcVbhMC2CTAsBC6WdmJWD3SFnWhYyLQQsFGRWHdRn8QrTspBpIWChILNqd3EMd3ApMi0ELJTWMKsYMqvGmBauHiJgobSOWZnIrMJgWhgRj4CF0kxm1cVZFyajT8txWhYyLQQslKYwK4yzahJoIdNCwEJBZtUhfRxHpoWAhYLMqlPEMaobpjFOCwELJTiziiGzamWfRyshD8i0ELBQgjArzJ45SaBFmRayWgQsFGRWnQJapdQ0FjItBCwUZFYdAFoxahcOJMpMCwUBC4XHrHA1sH2eCUwUa0WfFgIWSh2zwkyhbcm0qquH+GwQsHBAuJkVDoh2fUYlRzz6tBCwkFkhWHUOaFGmlcC6hwhYyKxwAHQQ0ypt40GmhYCFzAqlE0CrlE8rgRHxCFhThVkZCFbdwbRw9RABayowqxjuDewOpmVijngErC5mVhhn1ZXmYYlpoU8LAavrmBWagV3LtNCnhYDVhcwKwapbnzH6tBCwkFmhdBzTQp8WAhYyK5QOAi30aSFgIbNC6STQqmZ5QKaFgIXMCqXtdQCQaSFgIbNCQaaFgoAVIrMyEKxQeEzLRqaFgNWGzCqGYIXCYVqlJIDItBCw2oVZoRmIogNayLQQsNqCWSFYoWgzLawwjYCFzAqlY0DLRKaFgDVZzAqzLqA0wLQs7A8ErJYyK8y6gNIA00og00LAagmzQjMQJSzQwtVDBKymMysEK5QQzUOMiEfAQmaF0klMaxpWmEbACpdZoYMdpXk6Vq57iD4tBKzQmBU62FFaAVrItBCwGmFWuN0GBZkWAlb7MytSZlZY5Rdl0pgW9gcCljazQp8VyuSCFgt5QKaFgKVgVgYyK5S2AK2YjT4tBCwVs8LQBZR20UmoMi30aSFgiZgVghVKuzEtXD1EwEJmhdJJOoqrhwhYyKxQOhC0kGmZU1UBkFmhdCJolXxaU7jC9JQELGRWKJ0KWuUN01M3Tsucag8cmRVKN4AWMw/tKRh+M6UAq1rdJo5ghdIVTGvqZS41p8oDtlxBoQ7qPEqHi1NlWkkWET91JuApAVjos0Lp1ok4apZDHqYK0zK7/YGizwql60GryrSmwOphVwNWlVmhzwql20GLuTrKq4fdHadldusDdDMr9FmhdLuM+7RKcVrdO0F3HWCBgT4rlCnMtMZXD7uTaZnd9sAQrFCQaVX3HnbfGOgqwEKfFQqKp8J0l9U9NLvlAaHPCgWFw7SS3eXT6grAQmaFgiJmWgy0uoVpmZ3+QJBZoaDImVa0i5hWRwMWOthRUPQm9miXMC2zUx8ARrCjoAQDrU5mWh0JWMisUFCCgVbZp2V1LNMyO63DkVmhoASXsk/LLAWXdiLT6ijAqlZkxtVAFJTGJv541afVYRHxZqd0cJlZWbgaiIISGtPqvL2HbQ9Y4GJWaAaioIQ7tqIdxrTMdu9Q28WsEKxQUJoDWgMdwrTMdu5IZFYoKK0Za+Orh23OtMx27UBkVigorWZaZtszLbMdOw6ZFQoKMq22ByxkVigoyLQ6ArDczArjrFBQJncstmucltkuHWRjnBUKSttINU6r3ZjWpAMW+qxQUNqXabWbT8uc7A5BnxUKSnuDVjvtPTQnsyOQWaGgdAjTKtU9nPwsD+ZkdQAyKxSUTjMPJ59pmZNx48isUFA6FbQqTGuSfFpmq28YmRUKSuczrcmqe9hSwEJmhYLSHaBVDnloPdMyW3WDFjIrFJTuZFot9GmZrbgxZFYoKF3MtFro0zKbfUPos0JBmSJMqwVj3GzmjSCzQkGZQkyrBT6tpgEWMisUFGRabQ9YZQc7MisUlKnLtJqX5cEMu8HIrFBQpjrTIuNMq20BC31WKCgoXqYVNmiZYTUQmRUKCoqIaYWFCWYYDSszKwQrFBQUPtMKy6dlNtqgCWZlIlihoKA0lWmZjTQEfVYoKCi6TGtaCHFaZtAGoBmIgoLiD7SqcVpGYMwwg1wYwQoFBSU40wru0zL9XhDBCgUFpVGmNRCQaZl+LoRghYKCEgZolR3xEd9My9S9AMZZoaCgNMM89JNPy9Q5MTIrFBSUpoFW0i79DAWwymBlYpwVCgpK00CLpabR8WmZshOV0xojWKGgoDQbtMxxnxb4BaxaMxDBCgUFpUXmYSm4VMy0TD5YIbNCQUGZHKY1wJiWoMK0yQcrZFYoKCiTA1qlkIekVVo9dDwgZLsPjFAzsM+1Gkiw/1BQUCZBSumWk8TYNlI0iuABLAZMvRSk5sbtEhUDw0B2hYKCMmnCMClJsSjREzEGi6ZBKoBkR+gnmw0jc/r64SPjphl1EKtQUFDaxUR0isSIxHLXOk56HgMs5sQqGoZz/2j+P9g9KCgo7SYRyqoyFRplYnegoKB0iiBgoaCgIGChoKCgIGChoKAgYKGgoKAgYKGgoKAgYKGgoCBgoaCgoCBgoaCgoCBgoaCgIGChoKCgIGChoKCgIGChoKAgYKGgoKAgYKGgoKAgYKGgoCBgoaCgoCBgoaCgoCBgoaCgIGChoKCgTILY7j92jFrT39obPXqfhP26AZOkns0VV947kr/j7tHcIwWspYOCgjLZ8srddy/9/Ni0+LEv7TJ9/ehuM2CQvrbR1wh9DdHXHYv6blgUMQewt1BQUFotkUjEWLFihQEAhpmh/3yo1/qfb81N3RIhxtztDhgj9JWmr8HK72/uiZzwy4V9v55rmwnsPhQUlMkSc594ZME5M5PfSFPgynPMPvbW9iIYr45bB58zM3E2dhkKCsqkAdbpM+Kn9ptkcV7ho2Js6x290VPm2GYSuw0FBWVSAGuPmH1YQaM6PSVZxjTLXLYkYu6M3YaCgjIpgFU0YLqfBUCTGL3YbSgoKJMCWFkwVugGY4EBGXr8Buw2FBSUSQGs3w/nbrYJUR4Yo8esyjt//3em+Dx2GwoKyqQA1jXbMzc8mSnc3WOKQYt9Eqc07LtbM9/MAkaQoqCgTBJgbcg7zmdfTn9kW9F5ro+CluUBqhhhznZiXLc9e95PtmXuwC5DQUGZNMBKUpB6PG+sPHz10AF3Dud+6BjGcC/zrNNXgr7WFpynPrF+9JjT142cj92l2akU6yljjWJPoKCEK+N7Cf+bLW48ce3wR14Rtb60W9za3SZGcksBXnx8rPD0kAN57Cp9eW9/7OjZtjnv8i1jV2FvoKCEKLtX9hKihCP/Oz1+RH73mfC5mYkvY2+goDQuNXsJsTvCk+UzEm+/ZE7qtgLb5mQYBewRFJRwBQErLLCaHj/6gtnJW9IOJDAVDwoKAlYbg1Xify6ck/rlmAOxolFeXUVBQUHAakMzMH7ShXOSP6fMKlLE7kBBQcBqY2b1wQtnp66jYGUjWKGgIGC1rZw5I/GRC+Ykr6FgZSJYoaC0RmzsAn/C/FPfmps6/aPT4lcNO2A42CUoKAhYPBmwSGznqLVop6i1OEHIbAoWCQogefpzcHW+uG5t3ln9Yr64MdfEVbrL5qbO+uj0+GUsC2unLQbOtMz4zjFz8dKItWyGZS5YFDFn0r5LMaZNqXZ21IHBVXlnw9pCcdXKnLNiTb64KddBN8nMBXpP0xZFzaVLIvZ8yzBY6iSLvp8ZcmAz1ZE1L1Id2Vhw0pN5W9NMElsQNedOs8jcxRF7Bh2EKdoem7YzTyfBQdr/mzYXYP1LeWdTGsBpl75dHDWn07G3dJ5tLZlvm/No+6fRxsXpR0D7Or2h4Gx9qeC8tDJffGFVzln5csEZDbuf7T6LGN+YET13TiL6CjoGcyJiESfEvHTL2EWPjRVWyE6YMIl1aCryFnoDvbSxws6OECPyQs559slM4QnZ+RZGzL539EYPPzgVeffuMev1c2xrYYywr9cKy5jKBtxLheJ//pIu/PGO4dwtf03n/5kPsce+PTd1zkemxy9RgRXbFvAKCqpvSkX2TpqkJ9CDIQZ5dKzwD6q0w40o2S4xa8GRPdGjDkrZR+4as187yzLn0/6TTlQsLKMycJ5+Yqxw7+9G8rffN5p/jJq/oQweOunMe1XcOpA+m4Ki/eaD6fw924qwVcZ4X5+0d6I6cvS+iciRdEDt2WeSmW4FYb8ys52Cb3Fb0Vn/31zx738Yyd1x53D+jpW54pZmD3Y6xIzXxO0dqT4cdWAq8mY6Yewx3SLzYoQkvIrslPsfaF8PbSo6Lz6XK/7j4XTh/vvT+fufzhSfz7Qw+QDVXXO/hP3qo3oib6d9+6Ydo9butG9n2Ipl8Cw1PFg/P58rPv7QWOGuO4Zyd9JxviaMlpND9trDuHpw5SNLk7H9ZIObZXM4+sWhAygQ/EUBMPHHdhz4D73ZJUXJ+dhG66u3Zn6wfP3IR3mf7xazZi+fkTjjbT2R0+gg2yFfUjgoDSYQKC7LkhOhv8VJCcCcp7KFu6/ckvn6LUPZP4cAVl+kYPX1QQ1mxT5n6XjYxvGgD4nt5Tx+zfD+Nw9l/+b3u+zaR/dFD37fQOzM18btI+m5koWSIkEpc6yqTe6+ZPdABxE8ly0++pPB7OXXb8vc0uhWrbNnJo7+5tzUrUMSBSFl0DYOXjn4BgrcD3EA3XhXb+wNp02LnbN/InIUbWeUscEcvTtHoiMMPKL0tyj9uZUC4R9Gcz+6ZNPYpRTENoY94Nk1ju2LHXrqtPinXx23DqNWQczbRpku20Z5ZmazC2VaOTrB//3O4dwvfz2Uu+Xf2cK6ZgEVZU+pD0yLn3h0b/SjO8Ws10RocygI0YlY3Lfe9rPkL7FKP48CpB9KF26/amvm0rtHco/5HRMs0v2ZZ54xli1bZtjsy5SZsBnVkAU8QnmWUl6LHTDilHmsDLDY7J/h0F06uKxPzUh8nILDl/spmo/QQcYq+ehcl00+Wfob61zaT+ar4vbh18zvOfz4/uiPzt4wevbqvDMYEKy+StvzpUFNM5BUwLURc4qdoxAA7o7qib72C7MSF+0dt9/CUCVTqX7kR7x9yZqzJGru943ZyRtOG4idfeGm9CdvGco9GPTeWL+MFssVmVSAxaN0r47bi746O/kNyuSPZ8yJVXjKgN59MR1n/cpsQgoG0/+nL3bO4T3RUy7dPPapK7eM/Tws+2uPmLXokrmpKw5ORt7NzJYxBwzd1EzV/mfAVtUhhrM7Rc03nDsz8Ybl0+Pn/ymdv/XHWzNX3jOafzwszpWijOr06fGTP0rH3lzLXDJGG8HanfZ5HqiM/XSln2nbk9RCOuEQ+rwos73uyxvT5z6dLQZKBNpWq4SvSdhL71rcd/dnZyWupDPhDDbQigGfBlSUhA0KahJ96A9L+v/yuqS9awCwusgPWE2WzLBI/Afzei65cWHvw6+kYDVYKdUW1gBkwMUmjkUR6zU/nd97/w/n9VzQbxGrlffIQOzMGYkTfr+47wk6AI6nTK802QZ9Lgzs2DkoC5h94Zzkz+jk9h3m0mi0ne/tjx1O9e3vb6Rgtb3yHBrVHag8g8rk0/vWnugHblnU9+jti/pup0Dw2kbbTMfGzn+gY+/Ls5M/odbUku1OebIKQ+erpIi+zCPo5HDX4v7HT+yPHdXRgEUf8iF3LOp7aPe4fci2YnCg4nUWU8pZtrn7DQt673ldwt5Tc7Yxvjuv59IPT4t/rt3BijIOCvT99500EDuHKoU95jSvtYwl0P4k9Fqf/+WC3l8tipg9rbhHZiJTQL74ojnJG6i5NH0kxHtkrIv5Jd/TH1t+44Le65jvJui5KEN5NwXzO+mEO2ukSc/BKVsxDAjNw3oi7/zODj3XxAkhDbT5uNsX9v2NTnSHsn5o1tYydlpmycVNYwf6LH9LLYEzSYcBVqlrPjQt/i56A7+nM92c0SY9ZDaIB0xz3g0Le2/dI24tUA2Ony/ovfKUgdinBp32BqvDeyL7/GZx3wM7xazXtWrlkl2DTSqUQbyLzvC3zY+YqWZdiw6eIvM7Xb+g90fvG4h9tlkDqlp/8809kRP/37yey60Aw//tvdF9vsoCiQGieWjNcxgtm5omhatAgHXBnOSnvjU3dTP99kDaaY2m58uLOuSLs5JX0Gt/piMAq2KyjR3dF93/0rmpG6m9HJc95JLD1PUK0nBmk8+wzB3pjPSDlCAlNAMrOji+R2euM7YV23tNn4EVNc9+HyPGglYpm1sYc90xah1GB/hPEmb4OyhZ9ydNA66d3/st+jxO26p4HqZHR4K0iLHp4/qiZ5w5PfEBP9+bbpHY+XOS36Vt6O2Uze/UDP7sJ2YkLt3WRFYlY4lsgqAWzDc+NTNxStsDFluePSAVed3Fc1I30Bkizuuwci55UlpRZAMibxjpDBhb6Gu7RUiRvc8ypvpRTEal90vYRzHHPgesCAWrH9PB8bHBNgerfRP2jj+Z33trlJCZWZ9NZQ89ZpaWrY1e14v1MVuV8tOfjOIfmoq85+I5yfPCvsccHUdfnpX8ylE90U+KngdjQj2V9tuEOFQ3BulrM/3uaKKiO1GfyMWA+NMzExfvHpMzcbecOSNx6s5Ra98xn2EH7FmwxQX3qxWb5z87M3HaWTMSFw8FYOWsz9m4TLl0h/3O3vPDTBlosYrzX5iZvOotdPLV+c6kBY6y1Q+qEG+ACkX0SrI8Y+cfHyv86Q8judsfzxT+virnrKPgNsaCAefa5vS94vaeR/ZEjjk0FX0HPTqhqyxskJ02LX7uLwazNz+fK26qXM+kYHUt7bj3scFBZDashjSqdLLvz7HNxPfn9VxPB+RCXX8VO1+CkNKA2O7A9tVZ578v5Yur1hYcFoeUo4M6sThi7bAgYu1CTbxlEaobjLXpbDti/fXBgfh5948W7rl1KPvXsBg4bau9TyLyVl7sEWNQDKi2FOHlu0azLE7sD89ki/9ZX3BYzFaBAm9sp6i1gE5OB7yrL3biLlHrNaOa98MmTwp0c78wK/m5E9cOL1cd32+RCLUUPuaH5VafxaADw4MFWE+M0mKcTQf8tGkWmUU/j1bHCVtxDnP6fFdv9I2fnZW8yo9v1qqMSRYpsLngrF2bLz63plBcS1kvW3kHyjD7FtjW4iVRc7eZljmXzS9jGu0ulldrU5fO7fnuW1YNHvhywcm2JWARAVCxGZ49zPvT+Zsu25w5//507ine5Lom77z86FjhPz/alvnlG5ORXSm9veI1CfvwIQ1mxBRylk0WfHBa7NQvvJy+pMJY9n5Hb/R9QyWnIBEOoqymT4uVTos0EIdVmq0EsEXZzNfpAHy9brgC6096utwDo/k7bhrMXffQWP4hqnCbecxswCL2bjF71//pix3/nv7oh+nsOUflPK5MOpHPz0pccu9o7mBK9UOLzuaFArDZnILP5u9vy1zy3a2ZH76QK3LDVVbknJf+byT/yGVbMpdR0+OEc2YmLosTMkcn+JLd8xE90Q+8Lml/++G0PFj64GRk/yURa08dJ7tZHvjwt7HCHVR3f/j3scJjW4rOZlJWS5OlJp9nW3P2oM/gDUn7gH2T9mEUePemA9Vm7W7UN8YCsS+Zm/o+U/Oi5jhlDGqbA+tv2Z697vbh3K3/zBSe2lRwxhzOve0QMXsPSEZe9/6B2IfouDymCGCrLAB2XztGzH0/MzNx5tkbRr/ZloDFE6aIVNnXnrNp5GPXb8/+Vtcq+0s6/8xbVw8d8e25qcvf2x/7xLCjp5DH9cVOuXJL5gqK6pknM4VnD1s1uJ8jwBhm5tOZdMZlc1O30p99srax+6Dt/9512zNXUOUMVCmbzrTkX5ni09736Ux+0LF9sbOGNO6RKRsziR7NFP5w/qb0p+8dyf9L9S3a/4WH0vl/sdfVW63L6URw0Vt7oh8eUgA1U7rdYtYBpw7E33fZlrHrmjXJsft5aKzw689sGD39Hxm94EkKbnD5lrEb/prOP3LN/N47drDNV6pAi31KWWfP8X2x91PA+ors2ANSkYN1fCtmeUIeO2/j6Cnf2ZK5CfhW0sjmQmGEgsKKnw8av02Yxucpy3zlMX3R49/WE33/fJvFRxlG0HJ7X5qVPG+Bbb5KZ7JjE26UkNy1g9lLv7157JIVgonB3Xi2M+OXg9k/stfbeqP70cn1+4si1qtVYM7G7In9sbN/ui3z839li+vaHrAYvX86W7zvI+uGT3oqU1zv9/uM7p++fuST1FScdnAqcrKqg9h0RhV3V3rsgTfRzqUDdZSaFY/KvkOp+gz6vYLK3GOduipffIkywGdDBnTyuZnJr9NZ1tSJNmbA+dPt2S999uXRrwdZfaXm8pb3rhn+yBdnJ584e0biatqnRHYWZhKdMi3+yZ9uz9xATYVQU0RXmcn3tmU+/4WXRy8OEpRLWc2KU14afvdti/oeoGA0V+VoZibNW3qix06z0udvk9zPbpQB6dwsM6komJ9NJ8mbdNtMaQw8OJr/N3196WJ77KLj+qLHfnBa/GzKsPequkB0u+LQVGQvOtkt15nsmN+PVXn/5IaR996wPXt/kGf22+Hc3x7PFA74ybze6ylbPEZGJIrlyWj2x6YnPrp8/ciX287p7jFDDDq4b3jHi0NHBQGrqjC6/OkNo2dtLjorbA0nEuu+I3oi7zA6RCh7PPaVMesgHZOGskDjm5vHPkkf/tcbCRVhs+bXNqa/RxnKp/oUK4EMRJZGzFdT0/qtYYMVndByX9uUPokyq4sb2UFATbDnLtiUPiuhEbbEAG0eZSP7JuzXSCdbiyxUdTHTR8rk1/6QMoigbaffH7t6a+ZnB68c3IdOQu+jk+yKftMsD2KNPlk+PXEOVYu46lDWVtrHG45fM3xEULCqyvq8kz5h7dAJT1CWn1ToD3PAH9kb+cCiiNnftoDVT2/i10O5a45bM/S+zQqHm448lytuvWpL5sKkhkIyZ+becftAxlzaHazitIkfmhZfrjNYmc/h1qHcFRduSl8R1vW/vil9+b2j+RtTCqVjTOOE/tjJIYNV5iub0u+5dPPYL8I450+3ZW98MlO4N6547BWzkMWbHSiZGMh0i/QUFYjB9gWuyTtr1wfcHuaxJgrf3Zr5+YErB/f6wfbMNymjz1i1NZDr5MBkZPdDUpFjVZNXuXgyKX7+5dGT/5LO/zOM/qbsNPeJ9aMfHirCBtkqYsXqWfzuvthb2w6woGIGPjRW+Bk15T5EZ4vQFkKo/XzzuoKzUsWyKjPozkuj+svXkyVvSkVev1vMOljFrtgAezHvPEmZyOfDzEvC2Ov5m9LnZQGGZErD9i7uEbffTNs6PwyfFZ2VCxSsTqJgFVrVcdaHNwxmv68T7sD2Y9JJbX+hHkP5pT4P29ZkzlsUsfrCug+WvmX5upFzTl03cqzK30snkQ/Q+42pmsomuxsHs9+4dnv2j2Hq7z8yhRd/vD1zQQ9Rs3Rq9byn7QCLzW6UJj544prhU8MEKyYUrIYfThd+p5pBnfKASO0WtXZue3NwIHaCDg1kmRou2zz21Q0FJx12G/42Vnj+D8P5n8movVNmzQOH90QPaVhH6HUuouYbBatbw76X3w7n7t5UdNar4obyVDUXR8xdewUsfMgB2ObAFksRyMIAZY5tLjpjRvzjYd/LY2OFF8dAnEFjXsRMvqUnckxaMcwqZuvqizelv9UMHb5mW+ZaOjZfkBEJNuHtRa0elq2lrQCLpS35+1jhX1RpmlJV+t7R3D06A5wp7MKIuVM7gxWLu3pdwj5Kxa4YWD2dLT5841D2181qCz339Y4hjxNjZuEbk/ZbGmVXrL7jH0fzjzXjPigL3fZMtvi3qGpSA+ZjLSWrmyk8V875j47PlC0EnTotfv7Hp8ePa6X+HJSMvGGube6oWmRgbpSbhrLfX5V3tjajHWvzzvAD6fwtMiJRmfBm7puw92tHH1bTfEdPZYr/ZrOO6gJMIXeImAvbGbD2S9h7zbbNnVQKxyaB24ay16ad5mV5o8z18ZfyzrOyAcp8g6+M2a+bbpFIO/frv7PFJ1QNZAMoZRr98yPmDGGfjOXvszQXeXIOWBfMSd3wuVnJ01rlOD0kFTlcpRAMCIYdGL5pMPeLZraFMtvf6+STe30yclA7AlbT5KWC8zI1NTerFIl1zoApnj3bQV6bsN9o6yncyO9G8r9vZlu2FJ3c09nCYzJmUiibP0t3ilpL2rlfn88WV+gcZxFiU/Y6TfT5H0byf9xagHU6oFUsmz2R82YmfnTdgt4rZtlmrJn3yGKp9ozbb1Qt1sSo+f3PTOGBf2QKq5vZnsfHCk9tK8ImS+HH2j1m7cPrz64FLJYfjmUN0aF4dBbta+d7eXXc3j+vVExiUCr/xLPZ4upmt+e/ueJTlmISYBlAKWDt0s79OgLwsm5CRrZ9RPT5ilxx610juR+nNBebSxt/KbV/d2/0zP9b3Pfgm1ORPZt1j0si1pyFEXO3vIJ0M6b5t7HCH5vd5xsKsGVDwVllySY8qkE72ObOs6361EVdC1jbHKfI9iWpnKFMear7ttpR+i1iLo1aSoVjK14Pp/N/zrUg5/eKnLNSZ5C/Ima9sp11ZGXOyeRA7pco7Wk0WHyZJbUeL9o89u1NRee5iA87jwVwLo5Y+968qO/hb81Nfa7fDN+Eps9gWa9ZKhYhfVasH+4fzf+12X3OIvTX5Z0XZS4F5qahej93QcSsW73v2jJfRSgnwycax9GOaVvgnmmZM6jJOk+1bM0Ubn7EnL58RvwYVtygiQqX2T8ReY1qfxgbIMui1k5triZ+0N2Ug19x29c2jp151Q6p3w4DmLohJWwhxQQj8b/T4hcdnIoc++WN6TN+N5x7OKwbXBQxl1l67Ui/qSe676vi9jKbNA8XqB6P0fE2UzYBs0/i1AynE/WiR8cKz0wJwGqW1rZapllkdsI0BvIaG0gPS0U/+vae6EebeT/EKKfqZUvkRDERzLHaezEjbPnp9sxdO0bNs8+ambjMT9qWqom4LGLt84sFvQ/eMZz7/tc2pr/yXAgVfahZtZjo6X9y+fT41XaTxwMpm+KGitmyz+bbU4hhdYsspKwpSoipMvVIBbQyLUJfojEIKa2fHS1v85gyct7G9Lfpj75PzUx8xW9qbfb8CBj2u3qjyw9JRo65auvYF6/emrl2pIHyaoui5hzdyuQjLUwCqWM5s1JovmguyuQLpcb9nfiQ2FaVXpMM9JrNXQVrU9D66qWbx85me2Rtn7EL1bznUdOY96XZyWv+sKT/voNSkd0a0J+BTpwvWJv7OLFvCFhtLqy6dUcqHJSyRSR6zFJl4CknX9qYvvSTG0aPodizLRlgq2q1MMauMeug2xb2PfrV2cnTYyTQwE90qN6zbXN9CFidJx37jOhgiTmsnuYUlR9szdx27Jrh/Z/PFf/C2FagOgQO8/dA6tMzE1f9ZnH/r3cVbFmRiNWp/UdN2bpQEvRhtb9o55WKV9LutgMjY0F/xIEIKYf4TFn5azr/3GGrBw/5wqzkZz80Lf5F+nDifvO+M7bB/GH7Jex33bW4f+9PbRh5361DuT+HqT8MTJtRSCSolHLEExJHwOowodPjKNE7Dh7LFH61qehss9pgVqUDwMqCMTrmv3Bw1wkFm8I5G0YvuGs4d/v5c1JX7hWzDmUrZX4r1TCneMo0Fl8zv/eenaPp0y/ZPPYjjecwrANWww5suD+dv7NdGBkDq0fHCg8jYHWYbCw42/KVJWCZfsdNQq7aMvadO4ZzD2CvtafcO5r/12GrBt/8v9Pj71s+PXHBTIssHPFZnZutuBYAol+anfzh0qg1f/n6ka/KgO/lgrNVZYoyNkxZ3/aPrRv5+PaQM8Wif2SKyZYibM4bkNFxVOwZl2fGRJl8YRvTL908dv1BK7fvcf327MU2IWNJn6ZY1UQ8eSD2le/u0HOBbCVycxFeUp2dAd5c21y6rM33fiJgdYCsLzgbh4qwRaXTbFrcJ2EfiD3WGbIm7wx+fP3Iue94cXDvR9L5W1nivJiP1cRq9e33D8Q+/+VZqbNEx63MFVfqnCtJSGzfuL1Pu/cbAlabC1XKYTpLrrIVoXZsj9aecev1CyPmAPZa58jD6cJ/37p66Fhqjh1OJ6en+n2uJrLQhzNnxL/xP/2xQ3mfv5h3ns+CUVRuUTPKaWgQsFAaEgZEz2WLT6o21bKtMDMtc4fDUtGDsNc6S5iJd8Ng9o+HrNy+7/e2Zr5AmdZYzEfmhzyA/aVZyUvncFLVrMgVV28rOmtVDJ3p2WsT9pt34MQ+IWCh+JJ/ZAqP6CzdsFny6L7oSdhjnSlbipD9zIbRC9+zduh1lG091qvp22J7O5dFzVef1B87geNSGF2Zd/4ZVTD0SgGIRe/sjR6FgIXSkNyfzj+UBsiq1JcFGb4+GXknq5CCvda5cs9I/p+Hrxo88O7R/M/6NEGLlWF+Z1/0ZN7E9uBo/j6dghtsBfL9A/GPxdu4iBQCVgfI05nicy/knMeiemWp4stnxD+NvdbZQpnR2Elrh99PQeu6HlOvZN0uUeu1u8asug3DD6Tzd+v4sdjm673i1iHv7Y+9EwFrCgkDjgQhoQXgscjo+0bzt8c1Jj5Wd+6InugpVOnejE+is4Ux5k+uHzljTd55VuXDLCWiNEnf/Ii1zPvZ38YKT63IFR+NajAnBlqfmZk4f36kPtsnAlZnYpEyzo8dsDRqTg/zwrcPZW/NgJHWyW1EZ1ty/uzk1bvErFmT0UkzLTN2ydzUp14Zs3bsdoU4MBVZfGRP9FXNOv/qvDN0+3D2Oh0zjQ3m+Xa93jHgu2skd2NcY7Qzs3BRxNzjwtmpiyerT9+QjOxywZzUp01OFhoELB/CUjvRlzKIs5zF1NotzGs/PFZ4/pGx/J06+71YZPwM29zl2vm91822W5fehbXs2L7owXcv7Xv4E9MTl0YI6fqdFDtHrWV3LO579Ouzk8up6daU8fR0priKaPY/ZWLcQ28azN40WITNOg1kqZuP7Y+efuGc5Cda2ZcDFol+ZXbyE79d3PfPQ5ORYxzO5g4ELB9SAGM0b8B2lfJkS2WurH12jVk7hHn9727NXE0MveRnaaeUmuTIWxb2/mpJiNWGJbPiK6mi3XTN/N77FtnW3tuKTt5p72SuoUjGgUIeIH7WjMR37lva/8C7emP7h32NXTh+Ke5EWWZkI7zP/pUtrr99KKflDyuBFp11/3d64vJvzk2d1WyQiBFifmha/Og/Lx147OwZictpC6MjgsKwCFg+hFX5famUQF9d2KLfJNM/MBD7QKPXXBgxp9HZ+9S5thn/7XDuwYfS+V/rbuUYLVfRfdudi/v+fFRv9LVh9wfbg3ZYT2Tvny/ovfaORX1PUNB6D70mySjSJ3cZ6y4VTRgspzh+43ULev7yq0V9P9k3YS8L4/zMFHxTKvJ2VQ59UmLWUBwsOutFx3xva+bKEQe26jhXoWJKfmxa/LIbF/b+eGnU6g+776ZTRkWB6th7l/Y/9O25qVvn2ORVrB9l9QsQsHzKc7nikxFNsKAP4/NH9AQDimmWGT9jeuLUPy3tf4rOdOfZpOw7u2zL2NfpqbO6gMA21+5gkz1+saD3L5T9XPmqmL2oUTCZT0H049Pj771ncf8fb1nY9/e390ZPzgFE2T3DFNYNBtS0D6zDUpFTfrOo758/nNdz9QHJyM6NnPOTM+Kn7RG3D84qUtKwOYxOqOvWFJw1omOeyhZW/2Iwe7kuy4KKeUh1+NT7lvQ9+ekZidNm22ZDCQHZJPfquL3TN+akzqWM6qnL56Zu2SVq7jfkgFYqbczW4FP+li48cOqAca7quIpnvvf/zeu546wNIyfeNpS7X+f8u8eshScOxN97TF/0Iwttcyc2s253nOehYl79cST/+M1D2ctO6o+dO6iZg5udgwJK7Ni+6Blv64188JGxwm9/M5S7+c/p/MMrcs46OhhANnMzJV0WNZfum4jsf0gqcsTecetNsy1zVqkYxRQHKd4gZ5MEZQKp4/tjHz+mL3bqX8fyd944mP3R74Zz928rQlbnPGxV8HMzkx/9xIzElWmN58xWAJ/IFh6jFoA0ncw3N49dSgHomDm2uXdWMy8Xu5+ESRZ/ZXbyRx+bHv/iPaP5m+i9/OaxTOGf6/LOIEjbxSY4azoFpd0OTEUPemPSPmq3mLUf27vIVr8HfeaRR8DyKQ+m83/dXHRepA9wkU7praRpzKPM5o8n9ed+ceNQ7pqH0/kntxRhiOXZo6wpSk29aTtFraX7JOz9X5+wj9w7bh/Qa5JUuvIwedVvv7wx/fX9EvabF0Ws/TKaSucaSD0HJiPHH0pfww6Mri04K6jSrdhUcNbS621bk3ey9Pr24ojZQ689e0nUWjTfNnecYZH51DyxmGMh6/hXtKkmbMJiudnp44tTlvWeQ+hrzUxnBdWf39LXXX8fKzzxYt55mWVvcIPUwog1g5rZh9AJ6QzKRA4e1Uw/w9In/99I/jbVcesLTvqLL4+eSXXybqoLUd3UNiwSfog2tc8iS07sj51zAn3RcbCRAuRzVGdW0vvYQNndMMv9Nc82Y9TcG6BMbgdqSi6hDH9Zv2XOYKZojr3oPQ0FrJ+JgOVTqJIN3Tea/9VxfbGzhjU6PV/OXxQ5rCd68uH0tanobN5ehA1Uvxz6AHtm2OZM+mD77ArAZTVmnQ0FZ+yTG0Y/9KuFfX+ioDfdTyI4pqDVGZuxgGURa8+d6YtZCaTiI3DHbrBzs0q81bah+Gdc1f6eaZMd6UA/kw74M+kzHqbP8QXmEy0axlaWTppOCot3jFq7DphkGuvvYc1JgaWX2ZB3Vt82lL1D5/jbhnMP7rNt7NxPzUhcurXo75kyfajqPdXb2bvH7Nl7xo03VnWHvYqV+waX/oyGNMEhYAWQ727NfP/tvdEPM7biaCpt9YGlCJnZG5moBsL0JcjDvH80/9TZG0ZPuWxu6laHkrUgdaAcwwVCiEVNFzZ5VQuI0smql7LYvShA7VU1venEVjpmyKc+sD2HP9qauXJ13tmu+52vbhy7bIFt7XRMX/R/hwKCSRWMWqk76HQPIJTO//emwdwVLBWI32dVHFfc8stpoB0/3Z6589ItY6cOWMRpt0oDLAOqbUyZxcJAk0Wu4gNkLzZpZQPoQ4IQ47/Z4sNXbM1c5ed7bCvP8vUjyx8ZK/xswGqvx8TYfkKQZQcBK6BcsCl9wX+oovRMcuJ+2o7rz9owekLMJGPRNtA7Zp4wIKegfudayYpVtwgb65OlApFSkVrY+okNox/ZWHByfr9PTU7nuDXDH7h1KPeD6RZpi9klQUqglPvTaP5mBKwQhW1O/di6kZO2FWFVYpJ3t39/a+amk9cOHzbiGKt6J2n0MEVimQUyjrHm3JfTJ71t9dAxmwpO1xeg2FyEIWoaZVi/t3IwscnJNsjoGetHj2fugaDn2V50nNNeGvnot7eMfYbeQzE2SbrMwLef9uF/csW73/Xi0GvP25j+DgJWyPLoWOGFE9cOH7m56DzTDKAgFcqfIkRped45nPvrEasH97tnNH8DYzixFumdXQEq+v/gzwez5x+0cnDPK7eM3TBVHPS/G849eciqwb1+NZT7Ie32NOuLZjuGGaun5uO6k18aPurmoezdjZ6PmYeffzn9rZNfGjnk5YLzNNOfVrgYmIoyPWUm6dYi/PuzG9PHHbZy6C2UXf1LNjGiNCAPpfPPHrFq6MB7R/M3sY4PI5cQM6uY4idM4jyRKdxNTb4Pr8s7edX3/pstbjruxaGTPr5u5Kh1BXhioFzbLXSqXwVSdv40GBuuH8xeePiqoVdSxnne6nxx+1TTgSfGCv/94EvDHzly1dDuP9meuWiUggnrG1bxOcwBFquwEDpR3v7W1UP7/2Y492CY93HbUPbPh64c3Jcy9nPpdLOFXSvShImPmdEMdNkkvzLvPPbljen3H/DC4Guv3jL2K1XNxlLBDfZF1rg8yFFdx4nKDkiZhLDtI7IV01Q56X5TAZM57lgwkSXxZLIB3WgByZX54ubj1gwdf0J/7PrTpye+9KqYtS9zrjMnahHkcTTV5WC23SdaCS2gs9zqX4/mfn3zYPbaP6ULTxR8sBV23eu2Z++6czh/93F90XeeNBBbvkfMOpD2tc0iFvOVuB7wAU7V9kXK/gVjFCD9ZLbw5zuHcjfcMpT99Yt5Z9CvOZOiz6WguK5NmjujUhZhVtiKtD+YDukM3MczhVWPry98/pLNYxe9qzf61rf1xk7aO24dTMdWX9EoO9mr+qDT/2ZpcLNJp/z387niI1duyZxPmexv8k1isBuLTvrsDaMX/3hb5poPTYufdlRP9NQFEXMno6LPTBdBs/3EpT8RBn6V71GLZN2fxgq/v3kwc91dI/m/jDpQ1J4s933V7sar/v3vM6dHjWW0I0WzOInS16154zvPOcYq2QlnmEbkKz3GN2KGMU9yPgYmybtzxp3Xjxk/aZZCfjFlnL/MNl5BFUXokKSdmFjtGA98bcS4IiQTyTqUGAe8s8c44TUJ89C5trmMgQWvriB7jynwCMDQmrzz9GNpeODetHHXI4bx8LBhjIXVD7saxm5vjxnveH2KvGXHqLkXHUCzqrmRQKJo5ZUsgGEHtlKG98J/c/D4I2nj/vuLxoMvGcbaoO05Kmbsc0Lc+BxlZxmJsrPZzLpo1PjiC0Xj+Wboxy62scs5SeOrhXJ0iXAMJuncet2YcQHV13/4vcZcw5hzoGkcdGDKeNNuMbLfPNvckU7W/XaF+Yr6n8mYA/n1BWfFo2POPbePGjc+CMZfncYWlv2zOvr/G6g+H5U03vHqBDmIgtcrUoSkLIX+GBXdpiCX3+Y4G1bnnGefzhoP3z9m/OlRMP42rFHgdXyMRiLGM888Yyxbtswgnzv3XOPplasM05JbraVSQCYpbQEAxXEZHwFvqvM1IlnNKGE2A8RC8kGxGYilq2W0dwfbjLwiZi3dMWq9girq4sURc1aJrNJnOgbG4Kpccc2LBee5Z7LF517MF1/eWijPXjGz3C9hSEVpSu3qtUyDKlz/0oi1405Rc+l0y1ywJGLOYAH5FT0r0HZnKDgNbS3ClkEHNqzKF9etzTtrNxScraxCCxvZUVJ+mQHaWN6kW/ab6Hw71kRntlPREa1BU2GYfnQVKn3PmBXThxl0lNP+nzU/Yi2i/b6wrxwJPp1OcinWrRVdHKWMdSMFqlX/yRWffTZbXEkZd4E1M2GWmW4rhTG5DO0oUm6/uSRqzV0WsXZaGDGX0Ml4h9k26ac6wUrKO4QReMNIv5Arbs+AsXl13lm/seCsXUN1aGMB0qOOYzCYjprl/tS5E4d+hwHWxRdfbMyePdsggNHLKCgoHSL/X4ABAAK+fcWZNG1qAAAAAElFTkSuQmCC"/>
			</a>
		</div>

		<?php
	}

	/**
	 * Paneli kaydet
	 */
	public function in_mss_panel_kaydi() {
		add_menu_page(
			null,
			'Intense MSS',
			'manage_options',
			'intense-mss',
			'',
			''
		);

		add_submenu_page(
			'intense-mss',
			__( 'Kayıtlı Sözleşmeler', 'intense-mss-for-woocommerce' ),
			__( 'Kayıtlı Sözleşmeler', 'intense-mss-for-woocommerce' ),
			'manage_options',
			'intense-mss-kayitli-sozlesmeler',
			array( $this, 'kayitli_sozlesmeler' )
		);

		add_submenu_page(
			'intense-mss',
			__( 'Sözleşme Taslakları', 'intense-mss-for-woocommerce' ),
			__( 'Sözleşme Taslakları', 'intense-mss-for-woocommerce' ),
			'manage_options',
			'edit.php?post_type=intense_mss_form'
		);

		add_submenu_page(
			'intense-mss',
			__( 'Ayarlar', 'intense-mss-for-woocommerce' ),
			__( 'Ayarlar', 'intense-mss-for-woocommerce' ),
			'manage_options',
			'intense-mss-ayarlar',
			array( $this, 'ayarlar' )
		);

		remove_submenu_page( 'intense-mss', 'intense-mss' );
	}

	/**
	 * Sayfa seçiciyi ekrana basar.
	 *
	 * @param int $sayfa_no Sayfa numarası.
	 * @param int $sayfa_sayisi Toplam sayfa sayısı.
	 * @param int $sayfadaki_sozlesme_sayisi Sayfada gösterilen sözleşme sayısı.
	 *
	 * @return void
	 */
	private function sayfa_secici( $sayfa_no, $sayfa_sayisi, $sayfadaki_sozlesme_sayisi ) {
		?>
		<form action="admin.php" class="intense-mss-page-selector-form">
			<input type="hidden" name="page" value="intense-mss-kayitli-sozlesmeler">
			<select name="sayfa_no" class="intense-mss-page-selector" onchange="this.form.submit()">
				<?php foreach ( range( 1, $sayfa_sayisi ) as $i ) : ?>
					<option value="<?php echo esc_html( $i ); ?>" <?php selected( $i, $sayfa_no ); ?>><?php echo esc_html( $i ); ?></option>
				<?php endforeach; ?>
			</select>
			<?php /* translators: sayfada gosterilen sozlesme sayisi  */ ?>
			<span class="intense-mss-page-info"><?php echo esc_html( sprintf( __( '%d adet sözleşme gösteriliyor.', 'intense-mss-for-woocommerce' ), $sayfadaki_sozlesme_sayisi ) ); ?></span>
			<?php wp_nonce_field( self::NONCE_ACTION, '_wpnonce', false ); ?>
		</form>
		<?php
	}

	/**
	 * Kayitli sozlesmeler sayfasi icin render fonksoyun
	 *
	 * @return void|false
	 */
	public function kayitli_sozlesmeler() {
		// "page" parametresinden başka bir parametre varsa nonce verification yap
		if ( count( $_GET ) > 1 ) { // phpcs:ignore WordPress.Security.NonceVerification.Recommended
			$nonce = isset( $_GET['_wpnonce'] ) ? $_GET['_wpnonce'] : null; // phpcs:ignore WordPress.Security.NonceVerification.Recommended
			if ( ! wp_verify_nonce( $nonce, self::NONCE_ACTION ) ) {
				return false;
			}
		}

		global $wpdb;

		$sayfa = isset( $_GET['sayfa'] ) ? sanitize_key( $_GET['sayfa'] ) : false;

		$this->sayfa_basi( $sayfa );

		if ( 'mss' === $sayfa ) {

			$id = isset( $_GET['id'] ) ? intval( $_GET['id'] ) : 0;

			if ( ! $id ) {
				return;
			}

			$detaylar = $wpdb->get_row( $wpdb->prepare( "SELECT * FROM {$wpdb->prefix}intense_sozlesmeler WHERE id=%s", $id ) );
			$icerik   = $detaylar->mss_icerik;

			?>
			<p><strong><?php echo esc_html__( 'Sipariş No:', 'intense-mss-for-woocommerce' ); ?></strong><?php echo esc_html( $detaylar->order_id ); ?><p>
			<p><strong><?php echo esc_html__( 'Onay Tarihi:', 'intense-mss-for-woocommerce' ); ?></strong><?php echo esc_html( $detaylar->islem_zaman ); ?><p>
			<h3 style="margin-top:30px"><?php echo esc_html__( 'Mesafeli Satış Sözleşmesi', 'intense-mss-for-woocommerce' ); ?></h3>
			<?php
			echo wp_kses_post( $icerik );

		} elseif ( 'obf' === $sayfa ) {

			$id = isset( $_GET['id'] ) ? intval( $_GET['id'] ) : 0;

			if ( ! $id ) {
				return;
			}

			$detaylar = $wpdb->get_row( $wpdb->prepare( "SELECT * FROM {$wpdb->prefix}intense_sozlesmeler WHERE id=%s", $id ) );
			$icerik   = $detaylar->obf_icerik;

			?>
			<p><strong><?php echo esc_html__( 'Sipariş No:', 'intense-mss-for-woocommerce' ); ?></strong><?php echo esc_html( $detaylar->order_id ); ?></p>
			<p><strong><?php echo esc_html__( 'Onay Tarihi:', 'intense-mss-for-woocommerce' ); ?></strong><?php echo esc_html( $detaylar->islem_zaman ); ?></p>
			<h3 style="margin-top:30px"><?php echo esc_html__( 'Ön Bilgilendirme Formu', 'intense-mss-for-woocommerce' ); ?></h3>

			<?php
			echo wp_kses_post( $icerik );

		} elseif ( 'ozel-sozlesme-1' === $sayfa ) {
			$id = isset( $_GET['id'] ) ? intval( $_GET['id'] ) : 0;

			if ( ! $id ) {
				return;
			}

			$detaylar = $wpdb->get_row( $wpdb->prepare( "SELECT * FROM {$wpdb->prefix}intense_sozlesmeler WHERE id=%s", $id ) );
			$icerik   = $detaylar->ozel_sozlesme_1_icerik;

			?>
			<p><strong><?php echo esc_html__( 'Sipariş No:', 'intense-mss-for-woocommerce' ); ?></strong><?php echo esc_html( $detaylar->order_id ); ?></p>
			<p><strong><?php echo esc_html__( 'Onay Tarihi:', 'intense-mss-for-woocommerce' ); ?></strong><?php echo esc_html( $detaylar->islem_zaman ); ?></p>
			<h3 style="margin-top:30px"><?php echo esc_html( $detaylar->ozel_sozlesme_1_baslik ); ?></h3>

			<?php
			echo wp_kses_post( $icerik );

		}elseif ( 'ozel-sozlesme-2' === $sayfa ) {
			$id = isset( $_GET['id'] ) ? intval( $_GET['id'] ) : 0;

			if ( ! $id ) {
				return;
			}

			$detaylar = $wpdb->get_row( $wpdb->prepare( "SELECT * FROM {$wpdb->prefix}intense_sozlesmeler WHERE id=%s", $id ) );
			$icerik   = $detaylar->ozel_sozlesme_2_icerik;

			?>
			<p><strong><?php echo esc_html__( 'Sipariş No:', 'intense-mss-for-woocommerce' ); ?></strong><?php echo esc_html( $detaylar->order_id ); ?></p>
			<p><strong><?php echo esc_html__( 'Onay Tarihi:', 'intense-mss-for-woocommerce' ); ?></strong><?php echo esc_html( $detaylar->islem_zaman ); ?></p>
			<h3 style="margin-top:30px"><?php echo esc_html( $detaylar->ozel_sozlesme_2_baslik ); ?></h3>

			<?php
			echo wp_kses_post( $icerik );

		} elseif ( 'arama' === $sayfa ) {
			?>
			<a href="admin.php?page=intense-mss-kayitli-sozlesmeler" class="intense-mss-return-to-home"><?php esc_html_e( 'Ana Sayfaya Dön', 'intense-mss-for-woocommerce' ); ?></a>
			<?php
			$this->arama_kutusu();

			$siparis_no = isset( $_GET['siparis_no'] ) ? intval( $_GET['siparis_no'] ) : null;

			if ( $siparis_no ) {
				$sozlesme = $wpdb->get_results( $wpdb->prepare( "SELECT id, order_id, islem_zaman, ip_adresi FROM {$wpdb->prefix}intense_sozlesmeler WHERE order_id=%d", $siparis_no ) );
				if ( $sozlesme ) {
					$this->sozlesmeler_html_tablosu( $sozlesme );
				} else {
					?>
					<p><strong><?php esc_html_e( 'Kayıt bulunamadı.', 'intense-mss-for-woocommerce' ); ?></strong></p>
					<?php
				}
			}
		} else {
			$toplam_sozlesme_sayisi = intval( $wpdb->get_var( "SELECT COUNT(*) FROM {$wpdb->prefix}intense_sozlesmeler" ) );
			$sayfa_sayisi           = ceil( $toplam_sozlesme_sayisi / self::SAYFA_BASI_SOZLESME_SAYISI );

			$sayfa_no = isset( $_GET['sayfa_no'] ) ? intval( $_GET['sayfa_no'] ) : 1;
			if ( $sayfa_no < 1 || $sayfa_no > $sayfa_sayisi ) {
				$sayfa_no = 1;
			}
			$limit_icin_baslangic = ( $sayfa_no - 1 ) * self::SAYFA_BASI_SOZLESME_SAYISI;

			$sozlesmeler               = $wpdb->get_results( $wpdb->prepare( "SELECT id, order_id, islem_zaman, ozel_sozlesme_1_baslik, ozel_sozlesme_2_baslik, ip_adresi FROM {$wpdb->prefix}intense_sozlesmeler ORDER BY id DESC LIMIT %d,%d", $limit_icin_baslangic, self::SAYFA_BASI_SOZLESME_SAYISI ) );
			$sayfadaki_sozlesme_sayisi = count( $sozlesmeler );

			if ( $toplam_sozlesme_sayisi ) {
				$this->sayfa_secici( $sayfa_no, $sayfa_sayisi, $sayfadaki_sozlesme_sayisi );
				$this->arama_kutusu();
			}

			$this->sozlesmeler_html_tablosu( $sozlesmeler );

			if ( $toplam_sozlesme_sayisi ) {
				$this->sayfa_secici( $sayfa_no, $sayfa_sayisi, $sayfadaki_sozlesme_sayisi );
			}
		}

		$this->sayfa_sonu();
	}

	/**
	 * Sayfaların başlangıç HTML'ini basar.
	 *
	 * @param string $sayfa Sayfa.
	 *
	 * @return void
	 */
	private function sayfa_basi( $sayfa ) {
		$baslik = '';
		if ( 'arama' === $sayfa ) {
			$baslik = __( 'Arama', 'intense-mss-for-woocommerce' );
		} elseif ( false === $sayfa ) {
			$baslik = __( 'Kayıtlı Sözleşmeler', 'intense-mss-for-woocommerce' );
		}
		?>
		<div class="wrap">
			<h3><?php echo esc_html( $baslik ); ?></h3>
		<?php
	}

	/**
	 * Sayfaların son HTML'ini basar.
	 *
	 * @return void
	 */
	private function sayfa_sonu() {
		?>
		</div>
		<?php
	}

	/**
	 * Sözleşmeleri listeleyen HTML tablosu basar.
	 *
	 * @param array $sozlesmeler Sözleşmeler.
	 *
	 * @return void
	 */
	private function sozlesmeler_html_tablosu( $sozlesmeler ) {
		?>
		<div class="clear"></div>
		<table class="intense-mss-agreements-table" border="1">
			<thead align="left">
			<tr>
				<th><?php echo esc_html__( 'Sipariş No', 'intense-mss-for-woocommerce' ); ?></th>
				<th><?php echo esc_html__( 'Mesafeli Satış Sözleşmesi', 'intense-mss-for-woocommerce' ); ?></th>
				<th><?php echo esc_html__( 'Ön Bilgilendirme Formu', 'intense-mss-for-woocommerce' ); ?></th>
				<th><?php echo esc_html__( 'Özel Sözleşme - 1', 'intense-mss-for-woocommerce' ); ?></th>
				<th><?php echo esc_html__( 'Özel Sözleşme - 2', 'intense-mss-for-woocommerce' ); ?></th>
				<th><?php echo esc_html__( 'IP Adresi', 'intense-mss-for-woocommerce' ); ?></th>
				<th><?php echo esc_html__( 'Tarih', 'intense-mss-for-woocommerce' ); ?></th>
				<th><?php echo esc_html__( 'Zaman', 'intense-mss-for-woocommerce' ); ?></th>
			</tr>
			</thead>
			<tbody>
			<?php foreach ( $sozlesmeler as $sozlesme ) { ?>
				<tr>
					<td width="10%"><?php echo esc_html( $sozlesme->order_id ); ?></td>
					<?php // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?>
					<td width="15%"><a target='_blank' href="<?php echo wp_nonce_url( "admin.php?page=intense-mss-kayitli-sozlesmeler&sayfa=mss&id={$sozlesme->id}", self::NONCE_ACTION ); ?>"><?php echo esc_html__( 'Görüntüle', 'intense-mss-for-woocommerce' ); ?></a></td>
					<?php // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?>
					<td width="15%"><a target='_blank' href="<?php echo wp_nonce_url( "admin.php?page=intense-mss-kayitli-sozlesmeler&sayfa=obf&id={$sozlesme->id}", self::NONCE_ACTION ); ?>"><?php echo esc_html__( 'Görüntüle', 'intense-mss-for-woocommerce' ); ?></a></td>

					<td width="15%">
						<?php
						if( ! is_null( $sozlesme->ozel_sozlesme_1_baslik ) ):
							echo esc_html( $sozlesme->ozel_sozlesme_1_baslik ) ;
						?>
						- <a target='_blank' href="<?php echo wp_nonce_url( "admin.php?page=intense-mss-kayitli-sozlesmeler&sayfa=ozel-sozlesme-1&id={$sozlesme->id}", self::NONCE_ACTION ); ?>"><?php echo esc_html__( 'Görüntüle', 'intense-mss-for-woocommerce' ); ?>
						</a>
						<?php endif; ?>
					</td>

					<td width="15%">
						<?php
						if( ! is_null( $sozlesme->ozel_sozlesme_2_baslik ) ):
							echo esc_html( $sozlesme->ozel_sozlesme_2_baslik ) ;
						?>
						- <a target='_blank' href="<?php echo wp_nonce_url( "admin.php?page=intense-mss-kayitli-sozlesmeler&sayfa=ozel-sozlesme-2&id={$sozlesme->id}", self::NONCE_ACTION ); ?>"><?php echo esc_html__( 'Görüntüle', 'intense-mss-for-woocommerce' ); ?>
						</a>
						<?php endif; ?>
					</td>

					<td width="10%"><?php echo esc_html( $sozlesme->ip_adresi ); ?></td>
					<td width="10%"><?php echo esc_html( date_i18n( 'd/m/Y', strtotime( $sozlesme->islem_zaman ) ) ); ?></td>
					<td width="10%"><?php echo esc_html( date_i18n( 'H:i:s', strtotime( $sozlesme->islem_zaman ) ) ); ?></td>
				</tr>
			<?php } ?>
			</tbody>
		</table>
		<?php
	}

	/**
	 * Arama kutusunu ekrana basar.
	 *
	 * @return void
	 */
	private function arama_kutusu() {
		?>
		<form action="admin.php" class="intense-mss-search-form">
			<input type="hidden" name="page" value="intense-mss-kayitli-sozlesmeler">
			<input type="hidden" name="sayfa" value="arama">
			<input
				type="search"
				pattern="[0-9]+"
				class="intense-mss-search-box"
				name="siparis_no"
				placeholder="<?php esc_attr_e( 'Sipariş No', 'intense-mss-for-woocommerce' ); ?>"
				value=""
				required>
			<button type="submit" class="intense-mss-search-submit button">
				<?php esc_html_e( 'Ara', 'intense-mss-for-woocommerce' ); ?>
			</button>
			<?php wp_nonce_field( self::NONCE_ACTION, '_wpnonce', false ); ?>
		</form>
		<?php
	}

	/**
	 * Ayarlar
	 */
	public function ayarlar() {
		?>
		<div class="wrap">
			<h1><?php esc_html_e( 'Intense Mesafeli Satış Sözleşmesi & Ön Bilgilendirme Formu Genel Ayarlar', 'intense-mss-for-woocommerce' ); ?></h1>
			<form method="post" action="options.php">
				<?php
				settings_fields( 'intense_mss_alanlar' );
				do_settings_sections( 'intense-mss-ayarlar' );
				submit_button();
				?>
			</form>
		</div>
		<?php
	}

	/**
	 * Yazı değer alanlarını kaydet.
	 */
	public function intense_mss_page_init() {
		register_setting(
			'intense_mss_alanlar',
			'intense_mss_ayarlar',
			array( $this, 'sanitize' )
		);

		add_settings_section(
			'intense_mss_taslak_sozlesme_eslestirmeleri',
			__( 'Sözleşme Eşleştirmeleri', 'intense-mss-for-woocommerce' ),
			array( $this, 'aciklama_form_eslestirmeleri' ),
			'intense-mss-ayarlar'
		);

		add_settings_field(
			'mss-sozlesme-taslak-id',
			__( 'Mesafeli Satış Sözleşme Taslağını Seçiniz', 'intense-mss-for-woocommerce' ),
			array( $this, 'intense_mss_mss_taslak_id_callback' ),
			'intense-mss-ayarlar',
			'intense_mss_taslak_sozlesme_eslestirmeleri'
		);

		add_settings_field(
			'obf-sozlesme-taslak-id',
			__( 'Ön Bilgilendirme Formu Taslağını Seçiniz', 'intense-mss-for-woocommerce' ),
			array( $this, 'intense_mss_obf_taslak_id_callback' ),
			'intense-mss-ayarlar',
			'intense_mss_taslak_sozlesme_eslestirmeleri'
		);

		add_settings_field(
			'ozel-sozlesme-1-taslak-id',
			__( 'Özel Sözleşme 1 Taslağını Seçiniz (opsiyonel)', 'intense-mss-for-woocommerce' ),
			array( $this, 'intense_mss_ozel_sozlesme_1_taslak_id_callback' ),
			'intense-mss-ayarlar',
			'intense_mss_taslak_sozlesme_eslestirmeleri'
		);

		add_settings_field(
			'ozel-sozlesme-2-taslak-id',
			__( 'Özel Sözleşme 2 Taslağını Seçiniz (opsiyonel)', 'intense-mss-for-woocommerce' ),
			array( $this, 'intense_mss_ozel_sozlesme_2_taslak_id_callback' ),
			'intense-mss-ayarlar',
			'intense_mss_taslak_sozlesme_eslestirmeleri'
		);

		add_settings_field(
			'gosterilmeyecek-sozlesmeler',
			__( 'Gösterilmesini istemediğiniz sözleşmeler', 'intense-mss-for-woocommerce' ),
			array( $this, 'intense_mss_gosterilmeyecek_sozlesmeler_callback' ),
			'intense-mss-ayarlar',
			'intense_mss_taslak_sozlesme_eslestirmeleri'
		);

		add_settings_field(
			'yonetici-sozlesme-saklama-eposta-adresi',
			__( 'Sözleşmelerin Nüshalarının Gönderilmesini İstediğiniz E-Posta', 'intense-mss-for-woocommerce' ),
			array( $this, 'intense_sozlesme_saklama_eposta_adresi_callback' ),
			'intense-mss-ayarlar',
			'intense_mss_taslak_sozlesme_eslestirmeleri'
		);

		add_settings_field(
			'sozlesme-onay-checkbox-varsayilan-durum',
			__( 'Ödeme Ekranında Sözleşme Onaylarının Varsayılan Durumu', 'intense-mss-for-woocommerce' ),
			array( $this, 'sozlesme_onay_checkbox_varsayilan_durum' ),
			'intense-mss-ayarlar',
			'intense_mss_taslak_sozlesme_eslestirmeleri'
		);

		add_settings_field(
			'odeme-sayfasinda-sozlesme-gosterim-tipi',
			__( 'Ödeme Sayfasında Sözleşme Gösterim Tipi', 'intense-mss-for-woocommerce' ),
			array( $this, 'odeme_sayfasinda_sozlesme_gosterim_tipi' ),
			'intense-mss-ayarlar',
			'intense_mss_taslak_sozlesme_eslestirmeleri'
		);

		add_settings_field(
			'sozlesme-olusturma-tipi',
			__( 'Sözleşme Oluşturulma Tipi (Sözleşmelerin kullanıcıya e-posta gönderileceği ve veritabanı kaydının yapılacağı zamanı belirler.)', 'intense-mss-for-woocommerce' ),
			array( $this, 'sozlesme_olusturma_tipi' ),
			'intense-mss-ayarlar',
			'intense_mss_taslak_sozlesme_eslestirmeleri'
		);
	}

	/**
	 * Sanitize fonksiyonu
	 *
	 * @param  array $input form elementleri.
	 * @return array
	 */
	public function sanitize( $input ) {
		$new_input = array();

		if ( isset( $input['mss_taslak_id'] ) ) {
			$new_input['mss_taslak_id'] = sanitize_text_field( $input['mss_taslak_id'] );
		}

		if ( isset( $input['obf_taslak_id'] ) ) {
			$new_input['obf_taslak_id'] = sanitize_text_field( $input['obf_taslak_id'] );
		}

		if ( isset( $input['ozel_sozlesme_1_taslak_id'] ) ) {
			$new_input['ozel_sozlesme_1_taslak_id'] = sanitize_text_field( $input['ozel_sozlesme_1_taslak_id'] );
		}

		if ( isset( $input['ozel_sozlesme_2_taslak_id'] ) ) {
			$new_input['ozel_sozlesme_2_taslak_id'] = sanitize_text_field( $input['ozel_sozlesme_2_taslak_id'] );
		}

		if ( isset( $input['gosterilmeyecek_sozlesmeler'] ) ) {
			$new_input['gosterilmeyecek_sozlesmeler'] = array_map( 'sanitize_key', $input['gosterilmeyecek_sozlesmeler'] );
		}

		if ( isset( $input['sozlesme_onay_checkbox_varsayilan_durum'] ) ) {
			$new_input['sozlesme_onay_checkbox_varsayilan_durum'] = sanitize_text_field( $input['sozlesme_onay_checkbox_varsayilan_durum'] );
		}

		if ( isset( $input['yonetici_sozlesme_saklama_eposta_adresi'] ) ) {
			$new_input['yonetici_sozlesme_saklama_eposta_adresi'] = sanitize_text_field( $input['yonetici_sozlesme_saklama_eposta_adresi'] );
		}

		if ( isset( $input['odeme_sayfasinda_sozlesme_gosterim_tipi'] ) ) {
			$new_input['odeme_sayfasinda_sozlesme_gosterim_tipi'] = sanitize_text_field( $input['odeme_sayfasinda_sozlesme_gosterim_tipi'] );
		}

		if ( isset( $input['sozlesme_olusturma_tipi'] ) ) {
			$new_input['sozlesme_olusturma_tipi'] = sanitize_text_field( $input['sozlesme_olusturma_tipi'] );
		}

		return $new_input;
	}

	/**
	 * Kullanıcı hesap bilgileri bölümü açıklama yazısı
	 */
	public function aciklama_form_eslestirmeleri() {
		print esc_html__( 'Satın alma sayfasında gösterilecek formları oluşturduğunuz sözleşme taslaklarıyla eşleştiriniz.', 'intense-mss-for-woocommerce' );
	}

	/**
	 * Mesafeli satis sozlesmesi taslak eslestirmesi icin render fonksiyonu.
	 *
	 * @return void
	 */
	public function intense_mss_mss_taslak_id_callback() {

		$sozlesme_taslaklari = $this->mevcut_sozlesme_taslaklari_liste();

		?>
		<select name="intense_mss_ayarlar[mss_taslak_id]">
			<option value=""><?php esc_html_e( 'Lütfen Seçiniz', 'intense-mss-for-woocommerce' ); ?></option>
			<?php
			foreach ( $sozlesme_taslaklari as $sozlesme ) {
				$selected_status = '';

				if ( (int) ( $this->options['mss_taslak_id'] ?? '0' ) === $sozlesme->ID ) {
					$selected_status = 'selected ';
				}

				?>
				<option <?php echo esc_attr( $selected_status ); ?> value="<?php echo (int) $sozlesme->ID; ?>">
					<?php echo esc_html( $sozlesme->post_title ); ?>
				</option>
				<?php
			}
			?>
		</select>
		<?php
	}

	/**
	 * On bilgilendirme formu taslak secimi icin render fonksiyon
	 *
	 * @return void
	 */
	public function intense_mss_obf_taslak_id_callback() {
		$sozlesme_taslaklari = $this->mevcut_sozlesme_taslaklari_liste();

		?>
		<select name="intense_mss_ayarlar[obf_taslak_id]">
			<option value=""><?php esc_html_e( 'Lütfen Seçiniz', 'intense-mss-for-woocommerce' ); ?></option>
			<?php
			foreach ( $sozlesme_taslaklari as $sozlesme ) {
				$selected_status = '';

				if ( (int) ( $this->options['obf_taslak_id'] ?? '0' ) === $sozlesme->ID ) {
					$selected_status = 'selected ';
				}

				?>
				<option <?php echo esc_attr( $selected_status ); ?> value="<?php echo (int) $sozlesme->ID; ?>">
					<?php echo esc_html( $sozlesme->post_title ); ?>
				</option>
				<?php
			}
			?>
		</select>
		<?php
	}

	/**
	 * On bilgilendirme formu taslak secimi icin render fonksiyon
	 *
	 * @return void
	 */
	public function intense_mss_ozel_sozlesme_1_taslak_id_callback() {
		$sozlesme_taslaklari = $this->mevcut_sozlesme_taslaklari_liste();

		?>
		<select name="intense_mss_ayarlar[ozel_sozlesme_1_taslak_id]">
			<option value=""><?php esc_html_e( 'Lütfen Seçiniz', 'intense-mss-for-woocommerce' ); ?></option>
			<?php
			foreach ( $sozlesme_taslaklari as $sozlesme ) {
				$selected_status = '';

				if ( (int) ( $this->options['ozel_sozlesme_1_taslak_id'] ?? '0' ) === $sozlesme->ID ) {
					$selected_status = 'selected ';
				}

				?>
				<option <?php echo esc_attr( $selected_status ); ?> value="<?php echo (int) $sozlesme->ID; ?>">
					<?php echo esc_html( $sozlesme->post_title ); ?>
				</option>
				<?php
			}
			?>
		</select>
		<?php
	}

	/**
	 * On bilgilendirme formu taslak secimi icin render fonksiyon
	 *
	 * @return void
	 */
	public function intense_mss_ozel_sozlesme_2_taslak_id_callback() {
		$sozlesme_taslaklari = $this->mevcut_sozlesme_taslaklari_liste();

		?>
		<select name="intense_mss_ayarlar[ozel_sozlesme_2_taslak_id]">
			<option value=""><?php esc_html_e( 'Lütfen Seçiniz', 'intense-mss-for-woocommerce' ); ?></option>
			<?php
			foreach ( $sozlesme_taslaklari as $sozlesme ) {
				$selected_status = '';

				if ( (int) ( $this->options['ozel_sozlesme_2_taslak_id'] ?? '0' ) === $sozlesme->ID ) {
					$selected_status = 'selected ';
				}

				?>
				<option <?php echo esc_attr( $selected_status ); ?> value="<?php echo (int) $sozlesme->ID; ?>">
					<?php echo esc_html( $sozlesme->post_title ); ?>
				</option>
				<?php
			}
			?>
		</select>
		<?php
	}

	/**
	 * Mesafeli satis sozlesmesi taslak eslestirmesi icin render fonksiyonu.
	 *
	 * @return void
	 */
	public function intense_mss_gosterilmeyecek_sozlesmeler_callback() {
		$sozlesme_tipleri = array(
			'mss' => esc_html__( 'Mesafeli Satış Sözleşmesi', 'intense-mss-for-woocommerce' ),
			'obf' => esc_html__( 'Ön Bilgilendirme Formu', 'intense-mss-for-woocommerce' ),
			'custom_1' => esc_html__( 'Özel Sözleşme - 1', 'intense-mss-for-woocommerce' ),
			'custom_2' => esc_html__( 'Özel Sözleşme - 2', 'intense-mss-for-woocommerce' ),
		);

		$value = $this->options['gosterilmeyecek_sozlesmeler'] ?? array();

		?>
		<?php foreach($sozlesme_tipleri as $sozlesme_tipi => $sozlesme_tipi_label): ?>
			<p>
				<input <?php if(in_array( $sozlesme_tipi, $value, true )): ?>checked<?php endif; ?> type="checkbox" id="<?php echo esc_attr( $sozlesme_tipi ); ?>" name="intense_mss_ayarlar[gosterilmeyecek_sozlesmeler][]" value="<?php echo esc_attr( $sozlesme_tipi ); ?>" />
				<label for="<?php echo esc_attr( $sozlesme_tipi ); ?>"><?php echo esc_html( $sozlesme_tipi_label ); ?></label>
			</p>
		<?php endforeach; ?>
		<?php
	}

	/**
	 * Yonetici nusha e-posta adresi input field icin render fonksiyonu
	 *
	 * @return void
	 */
	public function intense_sozlesme_saklama_eposta_adresi_callback() {
		$value = $this->options['yonetici_sozlesme_saklama_eposta_adresi'] ?? '';

		printf( '<input name="intense_mss_ayarlar[yonetici_sozlesme_saklama_eposta_adresi]" value="%s" />', esc_html( $value ) );
	}

	/**
	 * 'Ödeme Ekranında Sözleşme Onaylarının Varsayılan Durumu' checkbox icin render fonksiyonu
	 *
	 * @return void
	 */
	public function sozlesme_onay_checkbox_varsayilan_durum() {
		$value = $this->options['sozlesme_onay_checkbox_varsayilan_durum'] ?? '';

		?>
		<select name="intense_mss_ayarlar[sozlesme_onay_checkbox_varsayilan_durum]">
			<option <?php echo ( '0' === $value ) ? 'selected' : ''; ?> value='0'><?php esc_html_e( 'İşaretsiz', 'intense-mss-for-woocommerce' ); ?></option>
			<option <?php echo ( '1' === $value ) ? 'selected' : ''; ?> value='1'><?php esc_html_e( 'İşaretli', 'intense-mss-for-woocommerce' ); ?></option>
		</select>
		<?php
	}

	/**
	 * 'Ödeme Sayfasında Sözleşme Gösterim Tipi' selectbox icin render fonksiyonu©`©
	 *
	 * @return void
	 */
	public function odeme_sayfasinda_sozlesme_gosterim_tipi() {
		$value = $this->options['odeme_sayfasinda_sozlesme_gosterim_tipi'] ?? '';
		?>
		<select name="intense_mss_ayarlar[odeme_sayfasinda_sozlesme_gosterim_tipi]">
			<option <?php echo 'inline' === $value ? 'selected' : ''; ?> value='inline'><?php esc_html_e( 'Sayfa içi', 'intense-mss-for-woocommerce' ); ?></option>
			<option <?php echo 'modal' === $value ? 'selected' : ''; ?> value='modal'><?php esc_html_e( 'Modal', 'intense-mss-for-woocommerce' ); ?></option>
		</select>
		<?php
	}

	/**
	 *
	 * Sözleşme oluşması sipariş oluşunca mı yapılsın, yoksa sipariş işleniyor durumuna geldiğinde mi yapılsın?
	 *
	 * $value = isleniyor => 'işleniyor durumunda'
	 * $value = yeni_siparis => 'sipariş alındığında'
	 */
	public function sozlesme_olusturma_tipi() {
		$value = $this->options['sozlesme_olusturma_tipi'] ?? '';
		?>
		<select name="intense_mss_ayarlar[sozlesme_olusturma_tipi]">
			<option value="yeni_siparis" <?php selected( $value, 'yeni_siparis' ); ?>><?php esc_html_e( 'Sipariş alındığında', 'intense-mss-for-woocommerce' ); ?></option>
			<option value="isleniyor" <?php selected( $value, 'isleniyor' ); ?>><?php esc_html_e( 'Sipariş işleniyor durumuna geldiğinde', 'intense-mss-for-woocommerce' ); ?></option>
		</select>
		<?php
	}
}
